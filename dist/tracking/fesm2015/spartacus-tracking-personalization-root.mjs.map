{"version":3,"file":"spartacus-tracking-personalization-root.mjs","sources":["../../../feature-libs/tracking/personalization/root/config/personalization-config.ts","../../../feature-libs/tracking/personalization/root/feature-name.ts","../../../feature-libs/tracking/personalization/root/config/default-personalization-config.ts","../../../feature-libs/tracking/personalization/root/http-interceptors/occ-personalization-id.interceptor.ts","../../../feature-libs/tracking/personalization/root/http-interceptors/occ-personalization-time.interceptor.ts","../../../feature-libs/tracking/personalization/root/http-interceptors/index.ts","../../../feature-libs/tracking/personalization/root/personalization-root.module.ts","../../../feature-libs/tracking/personalization/root/public_api.ts","../../../feature-libs/tracking/personalization/root/spartacus-tracking-personalization-root.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Injectable } from '@angular/core';\nimport { Config } from '@spartacus/core';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class PersonalizationConfig {\n  personalization?: {\n    enabled?: boolean;\n    httpHeaderName?: {\n      id: string;\n      timestamp: string;\n    };\n    context?: {\n      slotPosition: string;\n      componentId: string;\n    };\n  };\n}\n\ndeclare module '@spartacus/core' {\n  interface Config extends PersonalizationConfig {}\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const PERSONALIZATION_FEATURE = 'personalization';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { PersonalizationConfig } from './personalization-config';\n\nexport const defaultPersonalizationConfig: PersonalizationConfig = {\n  personalization: {\n    enabled: false,\n    httpHeaderName: {\n      id: 'Occ-Personalization-Id',\n      timestamp: 'Occ-Personalization-Time',\n    },\n    context: {\n      slotPosition: 'PlaceholderContentSlot',\n      componentId: 'PersonalizationScriptComponent',\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Injectable, inject, isDevMode } from '@angular/core';\nimport { LoggerService, OccEndpointsService, WindowRef } from '@spartacus/core';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { PersonalizationConfig } from '../config/personalization-config';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationIdInterceptor implements HttpInterceptor {\n  private personalizationId?: string | null;\n  private requestHeader?: string;\n  private enabled = false;\n  protected readonly PERSONALIZATION_ID_KEY = 'personalization-id';\n\n  protected logger = inject(LoggerService);\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef\n  ) {\n    if (this.winRef.isBrowser()) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization?.enabled) ||\n        false;\n\n      if (this.enabled) {\n        if (!this.config.personalization?.httpHeaderName && isDevMode()) {\n          this.logger.warn(\n            `There is no httpHeaderName configured in Personalization`\n          );\n        }\n        this.requestHeader =\n          this.config.personalization?.httpHeaderName?.id.toLowerCase();\n        this.personalizationId = this.winRef.localStorage?.getItem(\n          this.PERSONALIZATION_ID_KEY\n        );\n      } else if (\n        this.winRef.localStorage?.getItem(this.PERSONALIZATION_ID_KEY)\n      ) {\n        this.winRef.localStorage.removeItem(this.PERSONALIZATION_ID_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.requestHeader &&\n      this.personalizationId &&\n      request.url.includes(this.occEndpoints.getBaseUrl())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.personalizationId,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap((event) => {\n        if (\n          event instanceof HttpResponse &&\n          this.requestHeader &&\n          event.headers.keys().includes(this.requestHeader)\n        ) {\n          const receivedId = event.headers.get(this.requestHeader);\n          if (this.personalizationId !== receivedId) {\n            this.personalizationId = receivedId;\n            if (this.personalizationId) {\n              this.winRef.localStorage?.setItem(\n                this.PERSONALIZATION_ID_KEY,\n                this.personalizationId\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Injectable, inject, isDevMode } from '@angular/core';\nimport { LoggerService, OccEndpointsService, WindowRef } from '@spartacus/core';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { PersonalizationConfig } from '../config/personalization-config';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationTimeInterceptor implements HttpInterceptor {\n  private timestamp?: string | null;\n  private requestHeader?: string;\n  private enabled = false;\n  protected readonly PERSONALIZATION_TIME_KEY = 'personalization-time';\n\n  protected logger = inject(LoggerService);\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef\n  ) {\n    if (this.winRef.isBrowser()) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization?.enabled) ||\n        false;\n\n      if (this.enabled) {\n        if (!this.config.personalization?.httpHeaderName && isDevMode()) {\n          this.logger.warn(\n            `There is no httpHeaderName configured in Personalization`\n          );\n        }\n        this.requestHeader =\n          this.config.personalization?.httpHeaderName?.timestamp.toLowerCase();\n        this.timestamp = this.winRef.localStorage?.getItem(\n          this.PERSONALIZATION_TIME_KEY\n        );\n      } else if (\n        this.winRef.localStorage?.getItem(this.PERSONALIZATION_TIME_KEY)\n      ) {\n        this.winRef.localStorage.removeItem(this.PERSONALIZATION_TIME_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.requestHeader &&\n      this.timestamp &&\n      request.url.includes(this.occEndpoints.getBaseUrl())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.timestamp,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap((event) => {\n        if (\n          event instanceof HttpResponse &&\n          this.requestHeader &&\n          event.headers.keys().includes(this.requestHeader)\n        ) {\n          const receivedTimestamp = event.headers.get(this.requestHeader);\n          if (this.timestamp !== receivedTimestamp) {\n            this.timestamp = receivedTimestamp;\n            if (this.timestamp) {\n              this.winRef.localStorage?.setItem(\n                this.PERSONALIZATION_TIME_KEY,\n                this.timestamp\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n\n// CHECK SONAR\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { OccPersonalizationIdInterceptor } from './occ-personalization-id.interceptor';\nimport { OccPersonalizationTimeInterceptor } from './occ-personalization-time.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationIdInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationTimeInterceptor,\n    multi: true,\n  },\n];\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NgModule } from '@angular/core';\nimport {\n  CmsConfig,\n  provideDefaultConfig,\n  provideDefaultConfigFactory,\n} from '@spartacus/core';\nimport { defaultPersonalizationConfig } from './config/default-personalization-config';\nimport { PERSONALIZATION_FEATURE } from './feature-name';\nimport { interceptors } from './http-interceptors/index';\n\n// TODO: Inline this factory when we start releasing Ivy compiled libraries\nexport function defaultPersonalizationComponentsConfig(): CmsConfig {\n  const config: CmsConfig = {\n    featureModules: {\n      [PERSONALIZATION_FEATURE]: {\n        cmsComponents: ['PersonalizationScriptComponent'],\n      },\n    },\n  };\n\n  return config;\n}\n\n@NgModule({\n  providers: [\n    ...interceptors,\n    provideDefaultConfig(defaultPersonalizationConfig),\n    provideDefaultConfigFactory(defaultPersonalizationComponentsConfig),\n  ],\n})\nexport class PersonalizationRootModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './config/personalization-config';\nexport * from './feature-name';\nexport * from './personalization-root.module';\nexport * from './http-interceptors/occ-personalization-id.interceptor';\nexport * from './http-interceptors/occ-personalization-time.interceptor';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i1.PersonalizationConfig"],"mappings":"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"}