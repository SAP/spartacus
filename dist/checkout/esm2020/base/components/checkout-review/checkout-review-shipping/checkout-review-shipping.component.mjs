/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component } from '@angular/core';
import { CartOutlets, } from '@spartacus/cart/base/root';
import { deliveryAddressCard, deliveryModeCard } from '@spartacus/order/root';
import { ICON_TYPE } from '@spartacus/storefront';
import { combineLatest } from 'rxjs';
import { filter, map } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/cart/base/root";
import * as i2 from "@spartacus/checkout/base/root";
import * as i3 from "@spartacus/core";
import * as i4 from "../../services/checkout-step.service";
import * as i5 from "@angular/common";
import * as i6 from "@spartacus/storefront";
import * as i7 from "@angular/router";
export class CheckoutReviewShippingComponent {
    constructor(activeCartFacade, checkoutDeliveryModesFacade, checkoutDeliveryAddressFacade, translationService, checkoutStepService) {
        this.activeCartFacade = activeCartFacade;
        this.checkoutDeliveryModesFacade = checkoutDeliveryModesFacade;
        this.checkoutDeliveryAddressFacade = checkoutDeliveryAddressFacade;
        this.translationService = translationService;
        this.checkoutStepService = checkoutStepService;
        this.cartOutlets = CartOutlets;
        this.iconTypes = ICON_TYPE;
        this.deliveryAddressStepRoute = this.checkoutStepService.getCheckoutStepRoute("deliveryAddress" /* CheckoutStepType.DELIVERY_ADDRESS */);
        this.deliveryModeStepRoute = this.checkoutStepService.getCheckoutStepRoute("deliveryMode" /* CheckoutStepType.DELIVERY_MODE */);
        this.entries$ = this.activeCartFacade.getDeliveryEntries();
        this.deliveryAddress$ = this.checkoutDeliveryAddressFacade.getDeliveryAddressState().pipe(filter((state) => !state.loading && !state.error), map((state) => state.data));
        this.deliveryMode$ = this.checkoutDeliveryModesFacade.getSelectedDeliveryModeState().pipe(filter((state) => !state.loading && !state.error), map((state) => state.data));
    }
    getDeliveryAddressCard(deliveryAddress, countryName) {
        return combineLatest([
            this.translationService.translate('addressCard.shipTo'),
            this.translationService.translate('addressCard.phoneNumber'),
            this.translationService.translate('addressCard.mobileNumber'),
        ]).pipe(map(([textTitle, textPhone, textMobile]) => deliveryAddressCard(textTitle, textPhone, textMobile, deliveryAddress, countryName)));
    }
    getDeliveryModeCard(deliveryMode) {
        return combineLatest([
            this.translationService.translate('checkoutMode.deliveryMethod'),
        ]).pipe(map(([textTitle]) => deliveryModeCard(textTitle, deliveryMode)));
    }
}
CheckoutReviewShippingComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CheckoutReviewShippingComponent, deps: [{ token: i1.ActiveCartFacade }, { token: i2.CheckoutDeliveryModesFacade }, { token: i2.CheckoutDeliveryAddressFacade }, { token: i3.TranslationService }, { token: i4.CheckoutStepService }], target: i0.ɵɵFactoryTarget.Component });
CheckoutReviewShippingComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: CheckoutReviewShippingComponent, selector: "cx-checkout-review-shipping", ngImport: i0, template: "<ng-container *ngIf=\"entries$ | async as entries\">\n  <ng-container *ngIf=\"entries.length > 0\">\n    <h2 class=\"cx-review-header\">\n      {{ 'checkoutMode.deliveryEntries' | cxTranslate }}\n    </h2>\n\n    <div class=\"cx-review-summary cx-review-shipping-summary\">\n      <!-- DELIVERY ADDRESS SECTION -->\n      <div class=\"cx-review-summary-card-container\">\n        <div\n          *ngIf=\"deliveryAddress$ | async as deliveryAddress\"\n          class=\"cx-review-summary-card cx-review-card-address\"\n        >\n          <cx-card\n            [content]=\"getDeliveryAddressCard(deliveryAddress) | async\"\n          ></cx-card>\n          <div class=\"cx-review-summary-edit-step\">\n            <a\n              [attr.aria-label]=\"\n                'checkoutReview.editDeliveryAddressDetails' | cxTranslate\n              \"\n              [routerLink]=\"\n                {\n                  cxRoute: deliveryAddressStepRoute\n                } | cxUrl\n              \"\n              ><cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon\n            ></a>\n          </div>\n        </div>\n      </div>\n\n      <!-- DELIVERY MODE SECTION -->\n      <div class=\"cx-review-summary-card-container\">\n        <div class=\"cx-review-summary-card cx-review-card-address\">\n          <cx-card\n            *ngIf=\"deliveryMode$ | async as deliveryMode\"\n            [content]=\"getDeliveryModeCard(deliveryMode) | async\"\n          ></cx-card>\n          <div class=\"cx-review-summary-edit-step\">\n            <a\n              [attr.aria-label]=\"\n                'checkoutReview.editDeliveryMode' | cxTranslate\n              \"\n              [routerLink]=\"{ cxRoute: deliveryModeStepRoute } | cxUrl\"\n            >\n              <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- CART ITEM SECTION -->\n    <div class=\"cx-review-cart-item\">\n      <ng-template\n        [cxOutlet]=\"cartOutlets.CART_ITEM_LIST\"\n        [cxOutletContext]=\"{\n          items: entries,\n          readonly: true\n        }\"\n      >\n      </ng-template>\n    </div>\n  </ng-container>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i6.CardComponent, selector: "cx-card", inputs: ["border", "editMode", "isDefault", "content", "fitToContainer", "truncateText", "charactersLimit", "index"], outputs: ["deleteCard", "setDefaultCard", "sendCard", "editCard", "cancelCard"] }, { kind: "directive", type: i7.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "component", type: i6.IconComponent, selector: "cx-icon,[cxIcon]", inputs: ["cxIcon", "type"] }, { kind: "directive", type: i6.OutletDirective, selector: "[cxOutlet]", inputs: ["cxOutlet", "cxOutletContext", "cxOutletDefer", "cxComponentRef"], outputs: ["loaded", "cxComponentRefChange"] }, { kind: "pipe", type: i5.AsyncPipe, name: "async" }, { kind: "pipe", type: i3.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i3.UrlPipe, name: "cxUrl" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: CheckoutReviewShippingComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-checkout-review-shipping', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-container *ngIf=\"entries$ | async as entries\">\n  <ng-container *ngIf=\"entries.length > 0\">\n    <h2 class=\"cx-review-header\">\n      {{ 'checkoutMode.deliveryEntries' | cxTranslate }}\n    </h2>\n\n    <div class=\"cx-review-summary cx-review-shipping-summary\">\n      <!-- DELIVERY ADDRESS SECTION -->\n      <div class=\"cx-review-summary-card-container\">\n        <div\n          *ngIf=\"deliveryAddress$ | async as deliveryAddress\"\n          class=\"cx-review-summary-card cx-review-card-address\"\n        >\n          <cx-card\n            [content]=\"getDeliveryAddressCard(deliveryAddress) | async\"\n          ></cx-card>\n          <div class=\"cx-review-summary-edit-step\">\n            <a\n              [attr.aria-label]=\"\n                'checkoutReview.editDeliveryAddressDetails' | cxTranslate\n              \"\n              [routerLink]=\"\n                {\n                  cxRoute: deliveryAddressStepRoute\n                } | cxUrl\n              \"\n              ><cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon\n            ></a>\n          </div>\n        </div>\n      </div>\n\n      <!-- DELIVERY MODE SECTION -->\n      <div class=\"cx-review-summary-card-container\">\n        <div class=\"cx-review-summary-card cx-review-card-address\">\n          <cx-card\n            *ngIf=\"deliveryMode$ | async as deliveryMode\"\n            [content]=\"getDeliveryModeCard(deliveryMode) | async\"\n          ></cx-card>\n          <div class=\"cx-review-summary-edit-step\">\n            <a\n              [attr.aria-label]=\"\n                'checkoutReview.editDeliveryMode' | cxTranslate\n              \"\n              [routerLink]=\"{ cxRoute: deliveryModeStepRoute } | cxUrl\"\n            >\n              <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- CART ITEM SECTION -->\n    <div class=\"cx-review-cart-item\">\n      <ng-template\n        [cxOutlet]=\"cartOutlets.CART_ITEM_LIST\"\n        [cxOutletContext]=\"{\n          items: entries,\n          readonly: true\n        }\"\n      >\n      </ng-template>\n    </div>\n  </ng-container>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.ActiveCartFacade }, { type: i2.CheckoutDeliveryModesFacade }, { type: i2.CheckoutDeliveryAddressFacade }, { type: i3.TranslationService }, { type: i4.CheckoutStepService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tvdXQtcmV2aWV3LXNoaXBwaW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2ZlYXR1cmUtbGlicy9jaGVja291dC9iYXNlL2NvbXBvbmVudHMvY2hlY2tvdXQtcmV2aWV3L2NoZWNrb3V0LXJldmlldy1zaGlwcGluZy9jaGVja291dC1yZXZpZXctc2hpcHBpbmcuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL2NoZWNrb3V0L2Jhc2UvY29tcG9uZW50cy9jaGVja291dC1yZXZpZXcvY2hlY2tvdXQtcmV2aWV3LXNoaXBwaW5nL2NoZWNrb3V0LXJldmlldy1zaGlwcGluZy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHO0FBRUgsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNuRSxPQUFPLEVBRUwsV0FBVyxHQUdaLE1BQU0sMkJBQTJCLENBQUM7QUFPbkMsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGdCQUFnQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDOUUsT0FBTyxFQUFRLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3hELE9BQU8sRUFBRSxhQUFhLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDakQsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7O0FBUTdDLE1BQU0sT0FBTywrQkFBK0I7SUFXMUMsWUFDWSxnQkFBa0MsRUFDbEMsMkJBQXdELEVBQ3hELDZCQUE0RCxFQUM1RCxrQkFBc0MsRUFDdEMsbUJBQXdDO1FBSnhDLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDbEMsZ0NBQTJCLEdBQTNCLDJCQUEyQixDQUE2QjtRQUN4RCxrQ0FBNkIsR0FBN0IsNkJBQTZCLENBQStCO1FBQzVELHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFDdEMsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUFxQjtRQWYzQyxnQkFBVyxHQUFHLFdBQVcsQ0FBQztRQUNuQyxjQUFTLEdBQUcsU0FBUyxDQUFDO1FBRXRCLDZCQUF3QixHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxvQkFBb0IsMkRBRXZFLENBQUM7UUFDRiwwQkFBcUIsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsb0JBQW9CLHFEQUVwRSxDQUFDO1FBVUYsYUFBUSxHQUNOLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBRTdDLHFCQUFnQixHQUNkLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyx1QkFBdUIsRUFBRSxDQUFDLElBQUksQ0FDL0QsTUFBTSxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQ2pELEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUMzQixDQUFDO1FBRUosa0JBQWEsR0FDWCxJQUFJLENBQUMsMkJBQTJCLENBQUMsNEJBQTRCLEVBQUUsQ0FBQyxJQUFJLENBQ2xFLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUNqRCxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FDM0IsQ0FBQztJQWZELENBQUM7SUFpQkosc0JBQXNCLENBQ3BCLGVBQXdCLEVBQ3hCLFdBQW9CO1FBRXBCLE9BQU8sYUFBYSxDQUFDO1lBQ25CLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUM7WUFDdkQsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyx5QkFBeUIsQ0FBQztZQUM1RCxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLDBCQUEwQixDQUFDO1NBQzlELENBQUMsQ0FBQyxJQUFJLENBQ0wsR0FBRyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLFVBQVUsQ0FBQyxFQUFFLEVBQUUsQ0FDekMsbUJBQW1CLENBQ2pCLFNBQVMsRUFDVCxTQUFTLEVBQ1QsVUFBVSxFQUNWLGVBQWUsRUFDZixXQUFXLENBQ1osQ0FDRixDQUNGLENBQUM7SUFDSixDQUFDO0lBRUQsbUJBQW1CLENBQUMsWUFBMEI7UUFDNUMsT0FBTyxhQUFhLENBQUM7WUFDbkIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyw2QkFBNkIsQ0FBQztTQUNqRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0UsQ0FBQzs7NEhBM0RVLCtCQUErQjtnSEFBL0IsK0JBQStCLG1FQzlCNUMsNHNFQWtFQTsyRkRwQ2EsK0JBQStCO2tCQUwzQyxTQUFTOytCQUNFLDZCQUE2QixtQkFFdEIsdUJBQXVCLENBQUMsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFjdGl2ZUNhcnRGYWNhZGUsXG4gIENhcnRPdXRsZXRzLFxuICBEZWxpdmVyeU1vZGUsXG4gIE9yZGVyRW50cnksXG59IGZyb20gJ0BzcGFydGFjdXMvY2FydC9iYXNlL3Jvb3QnO1xuaW1wb3J0IHtcbiAgQ2hlY2tvdXREZWxpdmVyeUFkZHJlc3NGYWNhZGUsXG4gIENoZWNrb3V0RGVsaXZlcnlNb2Rlc0ZhY2FkZSxcbiAgQ2hlY2tvdXRTdGVwVHlwZSxcbn0gZnJvbSAnQHNwYXJ0YWN1cy9jaGVja291dC9iYXNlL3Jvb3QnO1xuaW1wb3J0IHsgQWRkcmVzcywgVHJhbnNsYXRpb25TZXJ2aWNlIH0gZnJvbSAnQHNwYXJ0YWN1cy9jb3JlJztcbmltcG9ydCB7IGRlbGl2ZXJ5QWRkcmVzc0NhcmQsIGRlbGl2ZXJ5TW9kZUNhcmQgfSBmcm9tICdAc3BhcnRhY3VzL29yZGVyL3Jvb3QnO1xuaW1wb3J0IHsgQ2FyZCwgSUNPTl9UWVBFIH0gZnJvbSAnQHNwYXJ0YWN1cy9zdG9yZWZyb250JztcbmltcG9ydCB7IGNvbWJpbmVMYXRlc3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGZpbHRlciwgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQ2hlY2tvdXRTdGVwU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2NoZWNrb3V0LXN0ZXAuc2VydmljZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2N4LWNoZWNrb3V0LXJldmlldy1zaGlwcGluZycsXG4gIHRlbXBsYXRlVXJsOiAnLi9jaGVja291dC1yZXZpZXctc2hpcHBpbmcuY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgQ2hlY2tvdXRSZXZpZXdTaGlwcGluZ0NvbXBvbmVudCB7XG4gIHJlYWRvbmx5IGNhcnRPdXRsZXRzID0gQ2FydE91dGxldHM7XG4gIGljb25UeXBlcyA9IElDT05fVFlQRTtcblxuICBkZWxpdmVyeUFkZHJlc3NTdGVwUm91dGUgPSB0aGlzLmNoZWNrb3V0U3RlcFNlcnZpY2UuZ2V0Q2hlY2tvdXRTdGVwUm91dGUoXG4gICAgQ2hlY2tvdXRTdGVwVHlwZS5ERUxJVkVSWV9BRERSRVNTXG4gICk7XG4gIGRlbGl2ZXJ5TW9kZVN0ZXBSb3V0ZSA9IHRoaXMuY2hlY2tvdXRTdGVwU2VydmljZS5nZXRDaGVja291dFN0ZXBSb3V0ZShcbiAgICBDaGVja291dFN0ZXBUeXBlLkRFTElWRVJZX01PREVcbiAgKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgYWN0aXZlQ2FydEZhY2FkZTogQWN0aXZlQ2FydEZhY2FkZSxcbiAgICBwcm90ZWN0ZWQgY2hlY2tvdXREZWxpdmVyeU1vZGVzRmFjYWRlOiBDaGVja291dERlbGl2ZXJ5TW9kZXNGYWNhZGUsXG4gICAgcHJvdGVjdGVkIGNoZWNrb3V0RGVsaXZlcnlBZGRyZXNzRmFjYWRlOiBDaGVja291dERlbGl2ZXJ5QWRkcmVzc0ZhY2FkZSxcbiAgICBwcm90ZWN0ZWQgdHJhbnNsYXRpb25TZXJ2aWNlOiBUcmFuc2xhdGlvblNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIGNoZWNrb3V0U3RlcFNlcnZpY2U6IENoZWNrb3V0U3RlcFNlcnZpY2VcbiAgKSB7fVxuXG4gIGVudHJpZXMkOiBPYnNlcnZhYmxlPE9yZGVyRW50cnlbXT4gPVxuICAgIHRoaXMuYWN0aXZlQ2FydEZhY2FkZS5nZXREZWxpdmVyeUVudHJpZXMoKTtcblxuICBkZWxpdmVyeUFkZHJlc3MkOiBPYnNlcnZhYmxlPEFkZHJlc3MgfCB1bmRlZmluZWQ+ID1cbiAgICB0aGlzLmNoZWNrb3V0RGVsaXZlcnlBZGRyZXNzRmFjYWRlLmdldERlbGl2ZXJ5QWRkcmVzc1N0YXRlKCkucGlwZShcbiAgICAgIGZpbHRlcigoc3RhdGUpID0+ICFzdGF0ZS5sb2FkaW5nICYmICFzdGF0ZS5lcnJvciksXG4gICAgICBtYXAoKHN0YXRlKSA9PiBzdGF0ZS5kYXRhKVxuICAgICk7XG5cbiAgZGVsaXZlcnlNb2RlJDogT2JzZXJ2YWJsZTxEZWxpdmVyeU1vZGUgfCB1bmRlZmluZWQ+ID1cbiAgICB0aGlzLmNoZWNrb3V0RGVsaXZlcnlNb2Rlc0ZhY2FkZS5nZXRTZWxlY3RlZERlbGl2ZXJ5TW9kZVN0YXRlKCkucGlwZShcbiAgICAgIGZpbHRlcigoc3RhdGUpID0+ICFzdGF0ZS5sb2FkaW5nICYmICFzdGF0ZS5lcnJvciksXG4gICAgICBtYXAoKHN0YXRlKSA9PiBzdGF0ZS5kYXRhKVxuICAgICk7XG5cbiAgZ2V0RGVsaXZlcnlBZGRyZXNzQ2FyZChcbiAgICBkZWxpdmVyeUFkZHJlc3M6IEFkZHJlc3MsXG4gICAgY291bnRyeU5hbWU/OiBzdHJpbmdcbiAgKTogT2JzZXJ2YWJsZTxDYXJkPiB7XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QoW1xuICAgICAgdGhpcy50cmFuc2xhdGlvblNlcnZpY2UudHJhbnNsYXRlKCdhZGRyZXNzQ2FyZC5zaGlwVG8nKSxcbiAgICAgIHRoaXMudHJhbnNsYXRpb25TZXJ2aWNlLnRyYW5zbGF0ZSgnYWRkcmVzc0NhcmQucGhvbmVOdW1iZXInKSxcbiAgICAgIHRoaXMudHJhbnNsYXRpb25TZXJ2aWNlLnRyYW5zbGF0ZSgnYWRkcmVzc0NhcmQubW9iaWxlTnVtYmVyJyksXG4gICAgXSkucGlwZShcbiAgICAgIG1hcCgoW3RleHRUaXRsZSwgdGV4dFBob25lLCB0ZXh0TW9iaWxlXSkgPT5cbiAgICAgICAgZGVsaXZlcnlBZGRyZXNzQ2FyZChcbiAgICAgICAgICB0ZXh0VGl0bGUsXG4gICAgICAgICAgdGV4dFBob25lLFxuICAgICAgICAgIHRleHRNb2JpbGUsXG4gICAgICAgICAgZGVsaXZlcnlBZGRyZXNzLFxuICAgICAgICAgIGNvdW50cnlOYW1lXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG5cbiAgZ2V0RGVsaXZlcnlNb2RlQ2FyZChkZWxpdmVyeU1vZGU6IERlbGl2ZXJ5TW9kZSk6IE9ic2VydmFibGU8Q2FyZD4ge1xuICAgIHJldHVybiBjb21iaW5lTGF0ZXN0KFtcbiAgICAgIHRoaXMudHJhbnNsYXRpb25TZXJ2aWNlLnRyYW5zbGF0ZSgnY2hlY2tvdXRNb2RlLmRlbGl2ZXJ5TWV0aG9kJyksXG4gICAgXSkucGlwZShtYXAoKFt0ZXh0VGl0bGVdKSA9PiBkZWxpdmVyeU1vZGVDYXJkKHRleHRUaXRsZSwgZGVsaXZlcnlNb2RlKSkpO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwiZW50cmllcyQgfCBhc3luYyBhcyBlbnRyaWVzXCI+XG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCJlbnRyaWVzLmxlbmd0aCA+IDBcIj5cbiAgICA8aDIgY2xhc3M9XCJjeC1yZXZpZXctaGVhZGVyXCI+XG4gICAgICB7eyAnY2hlY2tvdXRNb2RlLmRlbGl2ZXJ5RW50cmllcycgfCBjeFRyYW5zbGF0ZSB9fVxuICAgIDwvaDI+XG5cbiAgICA8ZGl2IGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnkgY3gtcmV2aWV3LXNoaXBwaW5nLXN1bW1hcnlcIj5cbiAgICAgIDwhLS0gREVMSVZFUlkgQUREUkVTUyBTRUNUSU9OIC0tPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LXJldmlldy1zdW1tYXJ5LWNhcmQtY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXZcbiAgICAgICAgICAqbmdJZj1cImRlbGl2ZXJ5QWRkcmVzcyQgfCBhc3luYyBhcyBkZWxpdmVyeUFkZHJlc3NcIlxuICAgICAgICAgIGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnktY2FyZCBjeC1yZXZpZXctY2FyZC1hZGRyZXNzXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxjeC1jYXJkXG4gICAgICAgICAgICBbY29udGVudF09XCJnZXREZWxpdmVyeUFkZHJlc3NDYXJkKGRlbGl2ZXJ5QWRkcmVzcykgfCBhc3luY1wiXG4gICAgICAgICAgPjwvY3gtY2FyZD5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnktZWRpdC1zdGVwXCI+XG4gICAgICAgICAgICA8YVxuICAgICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIlxuICAgICAgICAgICAgICAgICdjaGVja291dFJldmlldy5lZGl0RGVsaXZlcnlBZGRyZXNzRGV0YWlscycgfCBjeFRyYW5zbGF0ZVxuICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICBbcm91dGVyTGlua109XCJcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBjeFJvdXRlOiBkZWxpdmVyeUFkZHJlc3NTdGVwUm91dGVcbiAgICAgICAgICAgICAgICB9IHwgY3hVcmxcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgPjxjeC1pY29uIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIFt0eXBlXT1cImljb25UeXBlcy5QRU5DSUxcIj48L2N4LWljb25cbiAgICAgICAgICAgID48L2E+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDwhLS0gREVMSVZFUlkgTU9ERSBTRUNUSU9OIC0tPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LXJldmlldy1zdW1tYXJ5LWNhcmQtY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjeC1yZXZpZXctc3VtbWFyeS1jYXJkIGN4LXJldmlldy1jYXJkLWFkZHJlc3NcIj5cbiAgICAgICAgICA8Y3gtY2FyZFxuICAgICAgICAgICAgKm5nSWY9XCJkZWxpdmVyeU1vZGUkIHwgYXN5bmMgYXMgZGVsaXZlcnlNb2RlXCJcbiAgICAgICAgICAgIFtjb250ZW50XT1cImdldERlbGl2ZXJ5TW9kZUNhcmQoZGVsaXZlcnlNb2RlKSB8IGFzeW5jXCJcbiAgICAgICAgICA+PC9jeC1jYXJkPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJjeC1yZXZpZXctc3VtbWFyeS1lZGl0LXN0ZXBcIj5cbiAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiXG4gICAgICAgICAgICAgICAgJ2NoZWNrb3V0UmV2aWV3LmVkaXREZWxpdmVyeU1vZGUnIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwieyBjeFJvdXRlOiBkZWxpdmVyeU1vZGVTdGVwUm91dGUgfSB8IGN4VXJsXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPGN4LWljb24gYXJpYS1oaWRkZW49XCJ0cnVlXCIgW3R5cGVdPVwiaWNvblR5cGVzLlBFTkNJTFwiPjwvY3gtaWNvbj5cbiAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDwhLS0gQ0FSVCBJVEVNIFNFQ1RJT04gLS0+XG4gICAgPGRpdiBjbGFzcz1cImN4LXJldmlldy1jYXJ0LWl0ZW1cIj5cbiAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICBbY3hPdXRsZXRdPVwiY2FydE91dGxldHMuQ0FSVF9JVEVNX0xJU1RcIlxuICAgICAgICBbY3hPdXRsZXRDb250ZXh0XT1cIntcbiAgICAgICAgICBpdGVtczogZW50cmllcyxcbiAgICAgICAgICByZWFkb25seTogdHJ1ZVxuICAgICAgICB9XCJcbiAgICAgID5cbiAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgPC9kaXY+XG4gIDwvbmctY29udGFpbmVyPlxuPC9uZy1jb250YWluZXI+XG4iXX0=