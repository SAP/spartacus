/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component, ViewChild, } from '@angular/core';
import { SavedCartFormType, } from '@spartacus/cart/saved-cart/root';
import { Subscription } from 'rxjs';
import { map, take } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/core";
import * as i2 from "@spartacus/cart/saved-cart/root";
import * as i3 from "@spartacus/storefront";
import * as i4 from "@angular/common";
import * as i5 from "@angular/router";
export class SavedCartListComponent {
    constructor(routing, savedCartService, vcr, launchDialogService) {
        this.routing = routing;
        this.savedCartService = savedCartService;
        this.vcr = vcr;
        this.launchDialogService = launchDialogService;
        this.subscription = new Subscription();
        this.savedCarts$ = this.savedCartService.getList().pipe(map((lists) => lists.sort((a, b) => {
            const date1 = a.saveTime
                ? new Date(a.saveTime).getTime()
                : new Date().getTime();
            const date2 = b.saveTime
                ? new Date(b.saveTime).getTime()
                : new Date().getTime();
            return date2 - date1;
        })));
    }
    ngOnInit() {
        this.isLoading$ = this.savedCartService.getSavedCartListProcessLoading();
        this.savedCartService.loadSavedCarts();
    }
    goToSavedCartDetails(cart) {
        this.routing.go({
            cxRoute: 'savedCartsDetails',
            params: { savedCartId: cart?.code },
        });
    }
    openDialog(event, cart) {
        const dialog = this.launchDialogService.openDialog("SAVED_CART" /* LAUNCH_CALLER.SAVED_CART */, this.restoreButton, this.vcr, { cart, layoutOption: SavedCartFormType.RESTORE });
        if (dialog) {
            this.subscription.add(dialog.pipe(take(1)).subscribe());
        }
        event.stopPropagation();
    }
    ngOnDestroy() {
        this.savedCartService.clearSavedCarts();
        this.savedCartService.clearSaveCart();
        this.savedCartService.clearRestoreSavedCart();
        this.subscription?.unsubscribe();
    }
}
SavedCartListComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: SavedCartListComponent, deps: [{ token: i1.RoutingService }, { token: i2.SavedCartFacade }, { token: i0.ViewContainerRef }, { token: i3.LaunchDialogService }], target: i0.ɵɵFactoryTarget.Component });
SavedCartListComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: SavedCartListComponent, selector: "cx-saved-cart-list", viewQueries: [{ propertyName: "restoreButton", first: true, predicate: ["element"], descendants: true }], ngImport: i0, template: "<ng-container *ngIf=\"savedCarts$ | async as savedCarts\">\n  <ng-container *ngIf=\"!(isLoading$ | async); else loading\">\n    <div role=\"status\" [attr.aria-label]=\"'common.loaded' | cxTranslate\"></div>\n    <div class=\"cx-saved-cart-list-header\">\n      <h2>\n        {{\n          'savedCartList.savedCarts' | cxTranslate: { count: savedCarts.length }\n        }}\n      </h2>\n    </div>\n\n    <ng-container *ngIf=\"savedCarts?.length > 0; else noSavedCarts\">\n      <table class=\"table cx-saved-cart-list-table\">\n        <thead class=\"cx-saved-cart-list-thead-mobile\">\n          <th scope=\"col\">\n            {{ 'savedCartList.cartName' | cxTranslate }}\n          </th>\n          <th scope=\"col\">{{ 'savedCartList.cartId' | cxTranslate }}</th>\n          <th scope=\"col\">{{ 'savedCartList.dateSaved' | cxTranslate }}</th>\n          <th scope=\"col\" class=\"cx-saved-cart-list-th-qty\">\n            {{ 'savedCartList.quantity' | cxTranslate }}\n          </th>\n          <th scope=\"col\" class=\"cx-saved-cart-list-th-total\">\n            {{ 'savedCartList.total' | cxTranslate }}\n          </th>\n          <th scope=\"col\">\n            {{ 'savedCartList.actions' | cxTranslate }}\n          </th>\n        </thead>\n        <tbody>\n          <tr\n            *ngFor=\"let savedCart of savedCarts\"\n            (click)=\"goToSavedCartDetails(savedCart)\"\n          >\n            <td class=\"cx-saved-cart-list-cart-name\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.cartName' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.name }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-cart-id\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.cartId' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n                >{{ savedCart?.code }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-date-saved\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.dateSaved' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n                >{{ savedCart?.saveTime | cxDate: 'longDate' }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-quantity\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.quantity' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.totalUnitCount }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-total\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.total' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.totalPrice?.formattedValue }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-make-cart-active\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\"></div>\n              <button\n                #element\n                class=\"btn btn-tertiary cx-saved-cart-make-active\"\n                (click)=\"openDialog($event, savedCart)\"\n              >\n                {{ 'savedCartList.makeCartActive' | cxTranslate }}\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </ng-container>\n\n    <!-- NO SAVED CART CONTAINER -->\n    <ng-template #noSavedCarts>\n      <div class=\"cx-saved-cart-list-no-saved-carts row\">\n        <div class=\"col-sm-12 col-md-6 col-lg-4\">\n          <div>{{ 'savedCartList.notFound' | cxTranslate }}</div>\n        </div>\n      </div>\n    </ng-template>\n  </ng-container>\n\n  <ng-template #loading>\n    <div class=\"cx-spinner\">\n      <cx-spinner></cx-spinner>\n    </div>\n  </ng-template>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i5.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "component", type: i3.SpinnerComponent, selector: "cx-spinner" }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }, { kind: "pipe", type: i1.UrlPipe, name: "cxUrl" }, { kind: "pipe", type: i1.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i1.CxDatePipe, name: "cxDate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: SavedCartListComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-saved-cart-list', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-container *ngIf=\"savedCarts$ | async as savedCarts\">\n  <ng-container *ngIf=\"!(isLoading$ | async); else loading\">\n    <div role=\"status\" [attr.aria-label]=\"'common.loaded' | cxTranslate\"></div>\n    <div class=\"cx-saved-cart-list-header\">\n      <h2>\n        {{\n          'savedCartList.savedCarts' | cxTranslate: { count: savedCarts.length }\n        }}\n      </h2>\n    </div>\n\n    <ng-container *ngIf=\"savedCarts?.length > 0; else noSavedCarts\">\n      <table class=\"table cx-saved-cart-list-table\">\n        <thead class=\"cx-saved-cart-list-thead-mobile\">\n          <th scope=\"col\">\n            {{ 'savedCartList.cartName' | cxTranslate }}\n          </th>\n          <th scope=\"col\">{{ 'savedCartList.cartId' | cxTranslate }}</th>\n          <th scope=\"col\">{{ 'savedCartList.dateSaved' | cxTranslate }}</th>\n          <th scope=\"col\" class=\"cx-saved-cart-list-th-qty\">\n            {{ 'savedCartList.quantity' | cxTranslate }}\n          </th>\n          <th scope=\"col\" class=\"cx-saved-cart-list-th-total\">\n            {{ 'savedCartList.total' | cxTranslate }}\n          </th>\n          <th scope=\"col\">\n            {{ 'savedCartList.actions' | cxTranslate }}\n          </th>\n        </thead>\n        <tbody>\n          <tr\n            *ngFor=\"let savedCart of savedCarts\"\n            (click)=\"goToSavedCartDetails(savedCart)\"\n          >\n            <td class=\"cx-saved-cart-list-cart-name\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.cartName' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.name }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-cart-id\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.cartId' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n                >{{ savedCart?.code }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-date-saved\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.dateSaved' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n                >{{ savedCart?.saveTime | cxDate: 'longDate' }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-quantity\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.quantity' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.totalUnitCount }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-total\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\">\n                {{ 'savedCartList.total' | cxTranslate }}\n              </div>\n              <a\n                [routerLink]=\"\n                  {\n                    cxRoute: 'savedCartsDetails',\n                    params: { savedCartId: savedCart?.code }\n                  } | cxUrl\n                \"\n                class=\"cx-saved-cart-list-value\"\n              >\n                {{ savedCart?.totalPrice?.formattedValue }}</a\n              >\n            </td>\n            <td class=\"cx-saved-cart-list-make-cart-active\">\n              <div class=\"cx-table-label-mobile cx-saved-cart-list-label\"></div>\n              <button\n                #element\n                class=\"btn btn-tertiary cx-saved-cart-make-active\"\n                (click)=\"openDialog($event, savedCart)\"\n              >\n                {{ 'savedCartList.makeCartActive' | cxTranslate }}\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </ng-container>\n\n    <!-- NO SAVED CART CONTAINER -->\n    <ng-template #noSavedCarts>\n      <div class=\"cx-saved-cart-list-no-saved-carts row\">\n        <div class=\"col-sm-12 col-md-6 col-lg-4\">\n          <div>{{ 'savedCartList.notFound' | cxTranslate }}</div>\n        </div>\n      </div>\n    </ng-template>\n  </ng-container>\n\n  <ng-template #loading>\n    <div class=\"cx-spinner\">\n      <cx-spinner></cx-spinner>\n    </div>\n  </ng-template>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.RoutingService }, { type: i2.SavedCartFacade }, { type: i0.ViewContainerRef }, { type: i3.LaunchDialogService }]; }, propDecorators: { restoreButton: [{
                type: ViewChild,
                args: ['element']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2F2ZWQtY2FydC1saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2ZlYXR1cmUtbGlicy9jYXJ0L3NhdmVkLWNhcnQvY29tcG9uZW50cy9saXN0L3NhdmVkLWNhcnQtbGlzdC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvY2FydC9zYXZlZC1jYXJ0L2NvbXBvbmVudHMvbGlzdC9zYXZlZC1jYXJ0LWxpc3QuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUlULFNBQVMsR0FFVixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBRUwsaUJBQWlCLEdBQ2xCLE1BQU0saUNBQWlDLENBQUM7QUFHekMsT0FBTyxFQUFjLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNoRCxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7O0FBTzNDLE1BQU0sT0FBTyxzQkFBc0I7SUFtQmpDLFlBQ1ksT0FBdUIsRUFDdkIsZ0JBQWlDLEVBQ2pDLEdBQXFCLEVBQ3JCLG1CQUF3QztRQUh4QyxZQUFPLEdBQVAsT0FBTyxDQUFnQjtRQUN2QixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWlCO1FBQ2pDLFFBQUcsR0FBSCxHQUFHLENBQWtCO1FBQ3JCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUF0QjVDLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUsxQyxnQkFBVyxHQUF1QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUNwRSxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUNaLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFPLEVBQUUsQ0FBTyxFQUFFLEVBQUU7WUFDOUIsTUFBTSxLQUFLLEdBQVcsQ0FBQyxDQUFDLFFBQVE7Z0JBQzlCLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFO2dCQUNoQyxDQUFDLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUN6QixNQUFNLEtBQUssR0FBVyxDQUFDLENBQUMsUUFBUTtnQkFDOUIsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ2hDLENBQUMsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ3pCLE9BQU8sS0FBSyxHQUFHLEtBQUssQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FDSCxDQUNGLENBQUM7SUFNQyxDQUFDO0lBRUosUUFBUTtRQUNOLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLDhCQUE4QixFQUFFLENBQUM7UUFDekUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3pDLENBQUM7SUFFRCxvQkFBb0IsQ0FBQyxJQUFVO1FBQzdCLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ2QsT0FBTyxFQUFFLG1CQUFtQjtZQUM1QixNQUFNLEVBQUUsRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtTQUNwQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsVUFBVSxDQUFDLEtBQVksRUFBRSxJQUFVO1FBQ2pDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxVQUFVLDhDQUVoRCxJQUFJLENBQUMsYUFBYSxFQUNsQixJQUFJLENBQUMsR0FBRyxFQUNSLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FDbEQsQ0FBQztRQUVGLElBQUksTUFBTSxFQUFFO1lBQ1YsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO1NBQ3pEO1FBQ0QsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN0QyxJQUFJLENBQUMsZ0JBQWdCLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUM5QyxJQUFJLENBQUMsWUFBWSxFQUFFLFdBQVcsRUFBRSxDQUFDO0lBQ25DLENBQUM7O21IQXpEVSxzQkFBc0I7dUdBQXRCLHNCQUFzQixvS0M5Qm5DLHN5S0ErSUE7MkZEakhhLHNCQUFzQjtrQkFMbEMsU0FBUzsrQkFDRSxvQkFBb0IsbUJBRWIsdUJBQXVCLENBQUMsTUFBTTtvTUFLekIsYUFBYTtzQkFBbEMsU0FBUzt1QkFBQyxTQUFTIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIFNQRFgtRmlsZUNvcHlyaWdodFRleHQ6IDIwMjMgU0FQIFNwYXJ0YWN1cyB0ZWFtIDxzcGFydGFjdXMtdGVhbUBzYXAuY29tPlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHtcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NvbnRhaW5lclJlZixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDYXJ0IH0gZnJvbSAnQHNwYXJ0YWN1cy9jYXJ0L2Jhc2Uvcm9vdCc7XG5pbXBvcnQge1xuICBTYXZlZENhcnRGYWNhZGUsXG4gIFNhdmVkQ2FydEZvcm1UeXBlLFxufSBmcm9tICdAc3BhcnRhY3VzL2NhcnQvc2F2ZWQtY2FydC9yb290JztcbmltcG9ydCB7IFJvdXRpbmdTZXJ2aWNlIH0gZnJvbSAnQHNwYXJ0YWN1cy9jb3JlJztcbmltcG9ydCB7IExhdW5jaERpYWxvZ1NlcnZpY2UsIExBVU5DSF9DQUxMRVIgfSBmcm9tICdAc3BhcnRhY3VzL3N0b3JlZnJvbnQnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAsIHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2N4LXNhdmVkLWNhcnQtbGlzdCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9zYXZlZC1jYXJ0LWxpc3QuY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgU2F2ZWRDYXJ0TGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG5cbiAgQFZpZXdDaGlsZCgnZWxlbWVudCcpIHJlc3RvcmVCdXR0b246IEVsZW1lbnRSZWY7XG5cbiAgaXNMb2FkaW5nJDogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgc2F2ZWRDYXJ0cyQ6IE9ic2VydmFibGU8Q2FydFtdPiA9IHRoaXMuc2F2ZWRDYXJ0U2VydmljZS5nZXRMaXN0KCkucGlwZShcbiAgICBtYXAoKGxpc3RzKSA9PlxuICAgICAgbGlzdHMuc29ydCgoYTogQ2FydCwgYjogQ2FydCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRlMTogbnVtYmVyID0gYS5zYXZlVGltZVxuICAgICAgICAgID8gbmV3IERhdGUoYS5zYXZlVGltZSkuZ2V0VGltZSgpXG4gICAgICAgICAgOiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgY29uc3QgZGF0ZTI6IG51bWJlciA9IGIuc2F2ZVRpbWVcbiAgICAgICAgICA/IG5ldyBEYXRlKGIuc2F2ZVRpbWUpLmdldFRpbWUoKVxuICAgICAgICAgIDogbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIHJldHVybiBkYXRlMiAtIGRhdGUxO1xuICAgICAgfSlcbiAgICApXG4gICk7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCByb3V0aW5nOiBSb3V0aW5nU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgc2F2ZWRDYXJ0U2VydmljZTogU2F2ZWRDYXJ0RmFjYWRlLFxuICAgIHByb3RlY3RlZCB2Y3I6IFZpZXdDb250YWluZXJSZWYsXG4gICAgcHJvdGVjdGVkIGxhdW5jaERpYWxvZ1NlcnZpY2U6IExhdW5jaERpYWxvZ1NlcnZpY2VcbiAgKSB7fVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuaXNMb2FkaW5nJCA9IHRoaXMuc2F2ZWRDYXJ0U2VydmljZS5nZXRTYXZlZENhcnRMaXN0UHJvY2Vzc0xvYWRpbmcoKTtcbiAgICB0aGlzLnNhdmVkQ2FydFNlcnZpY2UubG9hZFNhdmVkQ2FydHMoKTtcbiAgfVxuXG4gIGdvVG9TYXZlZENhcnREZXRhaWxzKGNhcnQ6IENhcnQpOiB2b2lkIHtcbiAgICB0aGlzLnJvdXRpbmcuZ28oe1xuICAgICAgY3hSb3V0ZTogJ3NhdmVkQ2FydHNEZXRhaWxzJyxcbiAgICAgIHBhcmFtczogeyBzYXZlZENhcnRJZDogY2FydD8uY29kZSB9LFxuICAgIH0pO1xuICB9XG5cbiAgb3BlbkRpYWxvZyhldmVudDogRXZlbnQsIGNhcnQ6IENhcnQpOiB2b2lkIHtcbiAgICBjb25zdCBkaWFsb2cgPSB0aGlzLmxhdW5jaERpYWxvZ1NlcnZpY2Uub3BlbkRpYWxvZyhcbiAgICAgIExBVU5DSF9DQUxMRVIuU0FWRURfQ0FSVCxcbiAgICAgIHRoaXMucmVzdG9yZUJ1dHRvbixcbiAgICAgIHRoaXMudmNyLFxuICAgICAgeyBjYXJ0LCBsYXlvdXRPcHRpb246IFNhdmVkQ2FydEZvcm1UeXBlLlJFU1RPUkUgfVxuICAgICk7XG5cbiAgICBpZiAoZGlhbG9nKSB7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbi5hZGQoZGlhbG9nLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKCkpO1xuICAgIH1cbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc2F2ZWRDYXJ0U2VydmljZS5jbGVhclNhdmVkQ2FydHMoKTtcbiAgICB0aGlzLnNhdmVkQ2FydFNlcnZpY2UuY2xlYXJTYXZlQ2FydCgpO1xuICAgIHRoaXMuc2F2ZWRDYXJ0U2VydmljZS5jbGVhclJlc3RvcmVTYXZlZENhcnQoKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbj8udW5zdWJzY3JpYmUoKTtcbiAgfVxufVxuIiwiPG5nLWNvbnRhaW5lciAqbmdJZj1cInNhdmVkQ2FydHMkIHwgYXN5bmMgYXMgc2F2ZWRDYXJ0c1wiPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiIShpc0xvYWRpbmckIHwgYXN5bmMpOyBlbHNlIGxvYWRpbmdcIj5cbiAgICA8ZGl2IHJvbGU9XCJzdGF0dXNcIiBbYXR0ci5hcmlhLWxhYmVsXT1cIidjb21tb24ubG9hZGVkJyB8IGN4VHJhbnNsYXRlXCI+PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImN4LXNhdmVkLWNhcnQtbGlzdC1oZWFkZXJcIj5cbiAgICAgIDxoMj5cbiAgICAgICAge3tcbiAgICAgICAgICAnc2F2ZWRDYXJ0TGlzdC5zYXZlZENhcnRzJyB8IGN4VHJhbnNsYXRlOiB7IGNvdW50OiBzYXZlZENhcnRzLmxlbmd0aCB9XG4gICAgICAgIH19XG4gICAgICA8L2gyPlxuICAgIDwvZGl2PlxuXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInNhdmVkQ2FydHM/Lmxlbmd0aCA+IDA7IGVsc2Ugbm9TYXZlZENhcnRzXCI+XG4gICAgICA8dGFibGUgY2xhc3M9XCJ0YWJsZSBjeC1zYXZlZC1jYXJ0LWxpc3QtdGFibGVcIj5cbiAgICAgICAgPHRoZWFkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LXRoZWFkLW1vYmlsZVwiPlxuICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPlxuICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QuY2FydE5hbWUnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICA8L3RoPlxuICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPnt7ICdzYXZlZENhcnRMaXN0LmNhcnRJZCcgfCBjeFRyYW5zbGF0ZSB9fTwvdGg+XG4gICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCI+e3sgJ3NhdmVkQ2FydExpc3QuZGF0ZVNhdmVkJyB8IGN4VHJhbnNsYXRlIH19PC90aD5cbiAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIiBjbGFzcz1cImN4LXNhdmVkLWNhcnQtbGlzdC10aC1xdHlcIj5cbiAgICAgICAgICAgIHt7ICdzYXZlZENhcnRMaXN0LnF1YW50aXR5JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgPC90aD5cbiAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIiBjbGFzcz1cImN4LXNhdmVkLWNhcnQtbGlzdC10aC10b3RhbFwiPlxuICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QudG90YWwnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICA8L3RoPlxuICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPlxuICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QuYWN0aW9ucycgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgIDwvdGg+XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICA8dHJcbiAgICAgICAgICAgICpuZ0Zvcj1cImxldCBzYXZlZENhcnQgb2Ygc2F2ZWRDYXJ0c1wiXG4gICAgICAgICAgICAoY2xpY2spPVwiZ29Ub1NhdmVkQ2FydERldGFpbHMoc2F2ZWRDYXJ0KVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LWNhcnQtbmFtZVwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtdGFibGUtbGFiZWwtbW9iaWxlIGN4LXNhdmVkLWNhcnQtbGlzdC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgIHt7ICdzYXZlZENhcnRMaXN0LmNhcnROYW1lJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjeFJvdXRlOiAnc2F2ZWRDYXJ0c0RldGFpbHMnLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsgc2F2ZWRDYXJ0SWQ6IHNhdmVkQ2FydD8uY29kZSB9XG4gICAgICAgICAgICAgICAgICB9IHwgY3hVcmxcbiAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LXZhbHVlXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt7IHNhdmVkQ2FydD8ubmFtZSB9fTwvYVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LWNhcnQtaWRcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImN4LXRhYmxlLWxhYmVsLW1vYmlsZSBjeC1zYXZlZC1jYXJ0LWxpc3QtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICB7eyAnc2F2ZWRDYXJ0TGlzdC5jYXJ0SWQnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGN4Um91dGU6ICdzYXZlZENhcnRzRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogeyBzYXZlZENhcnRJZDogc2F2ZWRDYXJ0Py5jb2RlIH1cbiAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJjeC1zYXZlZC1jYXJ0LWxpc3QtdmFsdWVcIlxuICAgICAgICAgICAgICAgID57eyBzYXZlZENhcnQ/LmNvZGUgfX08L2FcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImN4LXNhdmVkLWNhcnQtbGlzdC1kYXRlLXNhdmVkXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjeC10YWJsZS1sYWJlbC1tb2JpbGUgY3gtc2F2ZWQtY2FydC1saXN0LWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QuZGF0ZVNhdmVkJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjeFJvdXRlOiAnc2F2ZWRDYXJ0c0RldGFpbHMnLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsgc2F2ZWRDYXJ0SWQ6IHNhdmVkQ2FydD8uY29kZSB9XG4gICAgICAgICAgICAgICAgICB9IHwgY3hVcmxcbiAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LXZhbHVlXCJcbiAgICAgICAgICAgICAgICA+e3sgc2F2ZWRDYXJ0Py5zYXZlVGltZSB8IGN4RGF0ZTogJ2xvbmdEYXRlJyB9fTwvYVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LXF1YW50aXR5XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjeC10YWJsZS1sYWJlbC1tb2JpbGUgY3gtc2F2ZWQtY2FydC1saXN0LWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QucXVhbnRpdHknIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGN4Um91dGU6ICdzYXZlZENhcnRzRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogeyBzYXZlZENhcnRJZDogc2F2ZWRDYXJ0Py5jb2RlIH1cbiAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJjeC1zYXZlZC1jYXJ0LWxpc3QtdmFsdWVcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3sgc2F2ZWRDYXJ0Py50b3RhbFVuaXRDb3VudCB9fTwvYVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LXRvdGFsXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjeC10YWJsZS1sYWJlbC1tb2JpbGUgY3gtc2F2ZWQtY2FydC1saXN0LWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3sgJ3NhdmVkQ2FydExpc3QudG90YWwnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGN4Um91dGU6ICdzYXZlZENhcnRzRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogeyBzYXZlZENhcnRJZDogc2F2ZWRDYXJ0Py5jb2RlIH1cbiAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJjeC1zYXZlZC1jYXJ0LWxpc3QtdmFsdWVcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3sgc2F2ZWRDYXJ0Py50b3RhbFByaWNlPy5mb3JtYXR0ZWRWYWx1ZSB9fTwvYVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiY3gtc2F2ZWQtY2FydC1saXN0LW1ha2UtY2FydC1hY3RpdmVcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImN4LXRhYmxlLWxhYmVsLW1vYmlsZSBjeC1zYXZlZC1jYXJ0LWxpc3QtbGFiZWxcIj48L2Rpdj5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICNlbGVtZW50XG4gICAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLXRlcnRpYXJ5IGN4LXNhdmVkLWNhcnQtbWFrZS1hY3RpdmVcIlxuICAgICAgICAgICAgICAgIChjbGljayk9XCJvcGVuRGlhbG9nKCRldmVudCwgc2F2ZWRDYXJ0KVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7eyAnc2F2ZWRDYXJ0TGlzdC5tYWtlQ2FydEFjdGl2ZScgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgPC90cj5cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9uZy1jb250YWluZXI+XG5cbiAgICA8IS0tIE5PIFNBVkVEIENBUlQgQ09OVEFJTkVSIC0tPlxuICAgIDxuZy10ZW1wbGF0ZSAjbm9TYXZlZENhcnRzPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LXNhdmVkLWNhcnQtbGlzdC1uby1zYXZlZC1jYXJ0cyByb3dcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS0xMiBjb2wtbWQtNiBjb2wtbGctNFwiPlxuICAgICAgICAgIDxkaXY+e3sgJ3NhdmVkQ2FydExpc3Qubm90Rm91bmQnIHwgY3hUcmFuc2xhdGUgfX08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L25nLXRlbXBsYXRlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctdGVtcGxhdGUgI2xvYWRpbmc+XG4gICAgPGRpdiBjbGFzcz1cImN4LXNwaW5uZXJcIj5cbiAgICAgIDxjeC1zcGlubmVyPjwvY3gtc3Bpbm5lcj5cbiAgICA8L2Rpdj5cbiAgPC9uZy10ZW1wbGF0ZT5cbjwvbmctY29udGFpbmVyPlxuIl19