"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=964,exports.ids=[964],exports.modules={12964:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BulkPricingModule:()=>BulkPricingModule});var core=__webpack_require__(40305),common=__webpack_require__(89318),spartacus_core=__webpack_require__(46167),spartacus_storefront=__webpack_require__(25907),switchMap=__webpack_require__(63714),of=__webpack_require__(95202);class BulkPricingService{constructor(productService){this.productService=productService,this.PRODUCT_SCOPE="bulkPrices"}getBulkPrices(productCode){return this.productService.get(productCode,this.PRODUCT_SCOPE).pipe((0,switchMap.w)(productPriceScope=>(0,of.of)(this.convert(productPriceScope))))}convert(productPriceScope){let bulkPrices=[];if(productPriceScope){const basePrice=productPriceScope.price?.value;bulkPrices=productPriceScope.volumePrices?.map(volumePrice=>this.parsePrice(volumePrice,basePrice))}return bulkPrices}parsePrice(priceTier,basePrice){const bulkPriceTemplate={currencyIso:priceTier.currencyIso,formattedValue:priceTier.formattedValue,maxQuantity:priceTier.maxQuantity,minQuantity:priceTier.minQuantity,priceType:priceTier.priceType,value:priceTier.value,formattedDiscount:"",discount:0};return this.calculateDiscount(bulkPriceTemplate,basePrice)}calculateDiscount(bulkPriceTemplate,basePrice){const bulkPrice=Object.assign({},bulkPriceTemplate),tierPrice=bulkPriceTemplate.value;if(tierPrice&&basePrice){const discount=Math.round(100-tierPrice/basePrice*100),formatted=0===discount?`${discount}%`:`-${discount}%`;bulkPrice.formattedDiscount=formatted,bulkPrice.discount=discount}return bulkPrice}}function BulkPricingTableComponent_ng_container_0_div_1_tr_14_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"tr")(1,"td"),core._uU(2),core.qZA(),core.TgZ(3,"td"),core._uU(4),core.qZA(),core.TgZ(5,"td"),core._uU(6),core.qZA()()),2&rf){const tier_r4=ctx.$implicit,ctx_r3=core.oxw(3);core.xp6(2),core.Oqu(ctx_r3.formatQuantity(tier_r4)),core.xp6(2),core.Oqu(tier_r4.formattedValue),core.xp6(2),core.Oqu(tier_r4.formattedDiscount)}}function BulkPricingTableComponent_ng_container_0_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",2)(1,"table",3)(2,"thead",4)(3,"tr")(4,"th",5),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core.TgZ(7,"th",5),core._uU(8),core.ALo(9,"cxTranslate"),core.qZA(),core.TgZ(10,"th",5),core._uU(11),core.ALo(12,"cxTranslate"),core.qZA()()(),core.TgZ(13,"tbody"),core.YNc(14,BulkPricingTableComponent_ng_container_0_div_1_tr_14_Template,7,3,"tr",6),core.qZA()()()),2&rf){const priceTiers_r1=core.oxw().ngIf;core.xp6(5),core.Oqu(core.lcZ(6,4,"bulkPricingTable.quantity")),core.xp6(3),core.Oqu(core.lcZ(9,6,"bulkPricingTable.price")),core.xp6(3),core.Oqu(core.lcZ(12,8,"bulkPricingTable.discount")),core.xp6(3),core.Q6J("ngForOf",priceTiers_r1)}}function BulkPricingTableComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,BulkPricingTableComponent_ng_container_0_div_1_Template,15,10,"div",1),core.BQk()),2&rf){const priceTiers_r1=ctx.ngIf;core.xp6(1),core.Q6J("ngIf",priceTiers_r1.length>0)}}__name(BulkPricingService,"BulkPricingService"),BulkPricingService.\u0275fac=__name(function(t){return new(t||BulkPricingService)(core.LFG(spartacus_core.M52))},"BulkPricingService_Factory"),BulkPricingService.\u0275prov=core.Yz7({token:BulkPricingService,factory:BulkPricingService.\u0275fac,providedIn:"root"}),__name(BulkPricingTableComponent_ng_container_0_div_1_tr_14_Template,"BulkPricingTableComponent_ng_container_0_div_1_tr_14_Template"),__name(BulkPricingTableComponent_ng_container_0_div_1_Template,"BulkPricingTableComponent_ng_container_0_div_1_Template"),__name(BulkPricingTableComponent_ng_container_0_Template,"BulkPricingTableComponent_ng_container_0_Template");class BulkPricingTableComponent{constructor(routingService,bulkPricingService){this.routingService=routingService,this.bulkPricingService=bulkPricingService,this.PRODUCT_KEY="productCode"}ngOnInit(){this.priceTiers$=this.getPrices()}formatQuantity(tier){let formattedQuantityRange="";return formattedQuantityRange=tier.maxQuantity?tier.minQuantity+" - "+tier.maxQuantity:tier.minQuantity+"+",formattedQuantityRange}getPrices(){return this.routingService.getRouterState().pipe((0,switchMap.w)(state=>{const productCode=state.state.params[this.PRODUCT_KEY];return this.bulkPricingService.getBulkPrices(productCode)}))}}__name(BulkPricingTableComponent,"BulkPricingTableComponent"),BulkPricingTableComponent.\u0275fac=__name(function(t){return new(t||BulkPricingTableComponent)(core.Y36(spartacus_core.Znh),core.Y36(BulkPricingService))},"BulkPricingTableComponent_Factory"),BulkPricingTableComponent.\u0275cmp=core.Xpm({type:BulkPricingTableComponent,selectors:[["cx-bulk-pricing-table"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","cx-bulk-pricing-table-container",4,"ngIf"],[1,"cx-bulk-pricing-table-container"],[1,"table"],[1,"thead-light"],["scope","col"],[4,"ngFor","ngForOf"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,BulkPricingTableComponent_ng_container_0_Template,2,1,"ng-container",0),core.ALo(1,"async")),2&rf&&core.Q6J("ngIf",core.lcZ(1,1,ctx.priceTiers$))},"BulkPricingTableComponent_Template"),dependencies:[common.sg,common.O5,common.Ov,spartacus_core.X$D],encapsulation:2});class BulkPricingTableModule{}__name(BulkPricingTableModule,"BulkPricingTableModule"),BulkPricingTableModule.\u0275fac=__name(function(t){return new(t||BulkPricingTableModule)},"BulkPricingTableModule_Factory"),BulkPricingTableModule.\u0275mod=core.oAB({type:BulkPricingTableModule}),BulkPricingTableModule.\u0275inj=core.cJS({imports:[common.ez,spartacus_core.LUR,spartacus_storefront.Fme,spartacus_core.pEA.withConfig({cmsComponents:{BulkPricingTableComponent:{component:BulkPricingTableComponent}}})]});class BulkPricingOccModule{}__name(BulkPricingOccModule,"BulkPricingOccModule"),BulkPricingOccModule.\u0275fac=__name(function(t){return new(t||BulkPricingOccModule)},"BulkPricingOccModule_Factory"),BulkPricingOccModule.\u0275mod=core.oAB({type:BulkPricingOccModule}),BulkPricingOccModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({backend:{occ:{endpoints:{product:{bulkPrices:"orgProducts/${productCode}?fields=price(DEFAULT),volumePrices(FULL)"}}}}})],imports:[common.ez]});class BulkPricingModule{}__name(BulkPricingModule,"BulkPricingModule"),BulkPricingModule.\u0275fac=__name(function(t){return new(t||BulkPricingModule)},"BulkPricingModule_Factory"),BulkPricingModule.\u0275mod=core.oAB({type:BulkPricingModule}),BulkPricingModule.\u0275inj=core.cJS({imports:[BulkPricingOccModule,BulkPricingTableModule]})}};