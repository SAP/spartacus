{"version":3,"file":"spartacus-pickup-in-store-occ.mjs","sources":["../../../feature-libs/pickup-in-store/occ/adapters/default-occ-pickup-location-config.ts","../../../feature-libs/pickup-in-store/occ/adapters/default-occ-stock-config.ts","../../../feature-libs/pickup-in-store/occ/adapters/occ-pickup-location.adapter.ts","../../../feature-libs/pickup-in-store/occ/adapters/occ-stock.adapter.ts","../../../feature-libs/pickup-in-store/occ/adapters/index.ts","../../../feature-libs/pickup-in-store/occ/model/occ-pickup-location-endpoints.model.ts","../../../feature-libs/pickup-in-store/occ/model/occ-stock-endpoints.model.ts","../../../feature-libs/pickup-in-store/occ/model/index.ts","../../../feature-libs/pickup-in-store/occ/pickup-in-store-occ.module.ts","../../../feature-libs/pickup-in-store/occ/public_api.ts","../../../feature-libs/pickup-in-store/occ/spartacus-pickup-in-store-occ.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccConfig } from '@spartacus/core';\n\n/**\n * The endpoints to call from the OCC adapter for pickup locations.\n */\nexport const defaultOccPickupLocationConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        storeDetails: 'stores/${storeName}',\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccConfig } from '@spartacus/core';\n\n/**\n * The endpoints to call from the OCC adapter for stock levels.\n */\nexport const defaultOccStockConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        stock: 'products/${productCode}/stock',\n        stockAtStore: 'products/${productCode}/stock/${storeName}',\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient } from '@angular/common/http';\nimport { inject, Injectable } from '@angular/core';\nimport {\n  LoggerService,\n  normalizeHttpError,\n  OccEndpointsService,\n  PointOfService,\n} from '@spartacus/core';\nimport { PickupLocationAdapter } from '@spartacus/pickup-in-store/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\n@Injectable()\nexport class OccPickupLocationAdapter implements PickupLocationAdapter {\n  protected logger = inject(LoggerService);\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService\n  ) {\n    // Intentional empty constructor\n  }\n\n  getStoreDetails(storeName: string): Observable<PointOfService> {\n    return this.http\n      .get<PointOfService>(\n        this.occEndpointsService.buildUrl('storeDetails', {\n          urlParams: { storeName },\n          queryParams: { fields: 'FULL' },\n        })\n      )\n      .pipe(\n        catchError((error: any) =>\n          throwError(normalizeHttpError(error, this.logger))\n        )\n      );\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient } from '@angular/common/http';\nimport { inject, Injectable } from '@angular/core';\nimport {\n  LoggerService,\n  normalizeHttpError,\n  OccEndpointsService,\n  Stock,\n  StoreFinderStockSearchPage,\n} from '@spartacus/core';\nimport { StockAdapter } from '@spartacus/pickup-in-store/core';\nimport { LocationSearchParams } from '@spartacus/pickup-in-store/root';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\n/**\n * Adapter for finding stock levels of a product in stores from the OCC APIs.\n */\n@Injectable()\nexport class OccStockAdapter implements StockAdapter {\n  protected logger = inject(LoggerService);\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService\n  ) {\n    // Intentional empty constructor\n  }\n\n  loadStockLevels(\n    productCode: string,\n    location: LocationSearchParams\n  ): Observable<StoreFinderStockSearchPage> {\n    return this.http\n      .get<StoreFinderStockSearchPage>(\n        this.occEndpointsService.buildUrl('stock', {\n          urlParams: { productCode },\n          queryParams: { ...location, fields: 'FULL' },\n        })\n      )\n      .pipe(\n        catchError((error: any) =>\n          throwError(normalizeHttpError(error, this.logger))\n        )\n      );\n  }\n\n  loadStockLevelAtStore(\n    productCode: string,\n    storeName: string\n  ): Observable<Stock> {\n    return this.http\n      .get<Stock>(\n        this.occEndpointsService.buildUrl('stockAtStore', {\n          urlParams: { productCode, storeName },\n        })\n      )\n      .pipe(\n        catchError((error: any) =>\n          throwError(normalizeHttpError(error, this.logger))\n        )\n      );\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './default-occ-pickup-location-config';\nexport * from './default-occ-stock-config';\nexport * from './occ-pickup-location.adapter';\nexport * from './occ-stock.adapter';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccEndpoint } from '@spartacus/core';\n\ndeclare module '@spartacus/core' {\n  interface OccEndpoints {\n    /**\n     * Get store details by store Name.\n     *\n     * @member {string} [storeDetails]\n     */\n    storeDetails?: string | OccEndpoint;\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccEndpoint } from '@spartacus/core';\n\ndeclare module '@spartacus/core' {\n  interface OccEndpoints {\n    /**\n     * Get a stock level for a product.\n     *\n     * @member {string} [page]\n     */\n    stock?: string | OccEndpoint;\n\n    /**\n     * Get a stock level for a product at a specific store.\n     *\n     * @member {string} [page]\n     */\n    stockAtStore?: string | OccEndpoint;\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Imported for side effects (module augmentation)\nimport './occ-pickup-location-endpoints.model';\nimport './occ-stock-endpoints.model';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NgModule } from '@angular/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport {\n  PickupLocationAdapter,\n  StockAdapter,\n} from '@spartacus/pickup-in-store/core';\nimport {\n  defaultOccPickupLocationConfig,\n  OccPickupLocationAdapter,\n} from './adapters';\n\nimport { defaultOccStockConfig } from './adapters/default-occ-stock-config';\nimport { OccStockAdapter } from './adapters/occ-stock.adapter';\n\n@NgModule({\n  providers: [\n    provideDefaultConfig(defaultOccPickupLocationConfig),\n    provideDefaultConfig(defaultOccStockConfig),\n    { provide: PickupLocationAdapter, useClass: OccPickupLocationAdapter },\n    { provide: StockAdapter, useClass: OccStockAdapter },\n  ],\n})\nexport class PickupInStoreOccModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './adapters/index';\nexport * from './model/index';\nexport * from './pickup-in-store-occ.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}