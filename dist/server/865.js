"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=865,exports.ids=[865],exports.modules={75865:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SmartEditModule:()=>SmartEditModule});var core=__webpack_require__(40305),spartacus_core=__webpack_require__(46167),filter=__webpack_require__(2026),take=__webpack_require__(95426),spartacus_smartedit_root=__webpack_require__(52656);class SmartEditService{constructor(cmsService,routingService,baseSiteService,zone,winRef,rendererFactory,config){if(this.cmsService=cmsService,this.routingService=routingService,this.baseSiteService=baseSiteService,this.zone=zone,this.winRef=winRef,this.rendererFactory=rendererFactory,this.config=config,this.isPreviewPage=!1,winRef.nativeWindow){const window=winRef.nativeWindow;window.smartedit=window.smartedit||{},window.smartedit.renderComponent=(componentId,componentType,parentId)=>this.renderComponent(componentId,componentType,parentId),window.smartedit.reprocessPage=this.reprocessPage}}processCmsPage(){this.baseSiteService.get().pipe((0,filter.h)(site=>Boolean(site)),(0,take.q)(1)).subscribe(site=>{this.defaultPreviewCategoryCode=site.defaultPreviewCategoryCode,this.defaultPreviewProductCode=site.defaultPreviewProductCode,this.cmsService.getCurrentPage().pipe((0,filter.h)(Boolean)).subscribe(cmsPage=>{this._currentPageId=cmsPage.pageId,this.goToPreviewPage(cmsPage),this.addPageContract(cmsPage)})})}addPageContract(cmsPage){const renderer=this.rendererFactory.createRenderer("body",null),element=this.winRef.document.body,previousContract=[];Array.from(element.classList).forEach(attr=>previousContract.push(attr)),previousContract.forEach(attr=>renderer.removeClass(element,attr)),this.addSmartEditContract(element,renderer,cmsPage.properties)}goToPreviewPage(cmsPage){this.isPreviewPage||(this.isPreviewPage=!0,cmsPage.type===spartacus_core.GV4.PRODUCT_PAGE&&this.defaultPreviewProductCode?this.routingService.go({cxRoute:"product",params:{code:this.defaultPreviewProductCode,name:""}}):cmsPage.type===spartacus_core.GV4.CATEGORY_PAGE&&this.defaultPreviewCategoryCode&&this.routingService.go({cxRoute:"category",params:{code:this.defaultPreviewCategoryCode}}))}renderComponent(componentId,componentType,parentId){return componentId&&this.zone.run(()=>{parentId?componentType&&this.cmsService.refreshComponent(componentId):this._currentPageId?this.cmsService.refreshPageById(this._currentPageId):this.cmsService.refreshLatestPage()}),!0}reprocessPage(){}addSmartEditContract(element,renderer,properties){properties&&Object.keys(properties).forEach(group=>{const name="data-"+group+"-",groupProps=properties[group];Object.keys(groupProps).forEach(propName=>{const propValue=groupProps[propName];"classes"===propName?propValue.split(" ").forEach(classItem=>{renderer.addClass(element,classItem)}):renderer.setAttribute(element,name+propName.split(/(?=[A-Z])/).join("-").toLowerCase(),propValue)})})}}__name(SmartEditService,"SmartEditService"),SmartEditService.\u0275fac=__name(function(t){return new(t||SmartEditService)(core.LFG(spartacus_core.ctt),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.Do$),core.LFG(core.R0b),core.LFG(spartacus_core.X9E),core.LFG(core.FYo),core.LFG(spartacus_smartedit_root.Yl))},"SmartEditService_Factory"),SmartEditService.\u0275prov=core.Yz7({token:SmartEditService,factory:SmartEditService.\u0275fac,providedIn:"root"});class SmartEditComponentDecorator extends spartacus_core.ryK{constructor(smartEditService){super(),this.smartEditService=smartEditService}decorate(element,renderer,component){component&&this.smartEditService.addSmartEditContract(element,renderer,component.properties)}}__name(SmartEditComponentDecorator,"SmartEditComponentDecorator"),SmartEditComponentDecorator.\u0275fac=__name(function(t){return new(t||SmartEditComponentDecorator)(core.LFG(SmartEditService))},"SmartEditComponentDecorator_Factory"),SmartEditComponentDecorator.\u0275prov=core.Yz7({token:SmartEditComponentDecorator,factory:SmartEditComponentDecorator.\u0275fac,providedIn:"root"});class SmartEditSlotDecorator extends spartacus_core.mR0{constructor(smartEditService){super(),this.smartEditService=smartEditService}decorate(element,renderer,slot){slot&&this.smartEditService.addSmartEditContract(element,renderer,slot.properties)}}__name(SmartEditSlotDecorator,"SmartEditSlotDecorator"),SmartEditSlotDecorator.\u0275fac=__name(function(t){return new(t||SmartEditSlotDecorator)(core.LFG(SmartEditService))},"SmartEditSlotDecorator_Factory"),SmartEditSlotDecorator.\u0275prov=core.Yz7({token:SmartEditSlotDecorator,factory:SmartEditSlotDecorator.\u0275fac,providedIn:"root"});const smartEditDecorators=[{provide:spartacus_core.ryK,useExisting:SmartEditComponentDecorator,multi:!0},{provide:spartacus_core.mR0,useExisting:SmartEditSlotDecorator,multi:!0}];class SmartEditCoreModule{constructor(smartEditService){this.smartEditService=smartEditService,this.smartEditService.processCmsPage()}}__name(SmartEditCoreModule,"SmartEditCoreModule"),SmartEditCoreModule.\u0275fac=__name(function(t){return new(t||SmartEditCoreModule)(core.LFG(SmartEditService))},"SmartEditCoreModule_Factory"),SmartEditCoreModule.\u0275mod=core.oAB({type:SmartEditCoreModule}),SmartEditCoreModule.\u0275inj=core.cJS({providers:[...smartEditDecorators]});class SmartEditModule{}__name(SmartEditModule,"SmartEditModule"),SmartEditModule.\u0275fac=__name(function(t){return new(t||SmartEditModule)},"SmartEditModule_Factory"),SmartEditModule.\u0275mod=core.oAB({type:SmartEditModule}),SmartEditModule.\u0275inj=core.cJS({imports:[SmartEditCoreModule]})}};