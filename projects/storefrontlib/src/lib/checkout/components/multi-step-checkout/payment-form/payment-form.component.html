<div class="content" *ngIf="existingPaymentMethods.length > 0 && !newPayment;else paymentForm">
    <h3>Payment Methods</h3>
    <div *ngFor="let method of existingPaymentMethods">
        <div class="payment-methods">
            <div>{{method.cardType.name}}
                <span *ngIf="method.defaultPayment"> (Default Payment Method)</span>
            </div>
            <div>{{method.accountHolderName}}</div>
            <div>{{method.cardNumber}}</div>
            <div>Expiry: {{method.expiryMonth}}/{{method.expiryYear}}</div>
            <div class="continue-link">
                <a [routerLink]="" (click)="paymentMethodSelected(method)">Use this Payment Method</a>
            </div>
        </div>
    </div>

    <div></div>
    <div class="buttons">
        <button mat-raised-button color="primary" (click)="back()">Go Back</button>
        <button mat-raised-button color="accent" (click)="addNewPaymentMethod()">Add a New Payment Method</button>
    </div>
</div>

<ng-template #paymentForm>
    <div [formGroup]="payment">
        <h3 class="heading">Choose a card type:</h3>
        <div class="content">
            <div>
                <div>
                    <font size="3">Account Holder Name:</font>
                </div>
                <input class="inputs" type="text" placeholder="Account Holder Name" formControlName="accountHolderName">
                <div class="error" *ngIf="required( 'accountHolderName')">Account Holder Name is required</div>
            </div>
            <div>
                <div>
                    <font size="3">Card Number:</font>
                </div>
                <input class="inputs" type="text" placeholder="Card Number" formControlName="cardNumber">
                <div class="error" *ngIf="required('cardNumber')">Card Number is required</div>
            </div>
            <div formGroupName="cardType">
                <div>
                    <font size="3">Card Type:</font>
                </div>
                <select class="card-types-dropdown" formControlName="code">
                    <option value="">Select Card Type</option>
                    <option *ngFor="let cardType of (cardTypes$ | async)" [value]="cardType.code">
                        {{ cardType.name }}
                    </option>
                </select>
                <div class="error" *ngIf="notSelected( 'cardType.code')">Card Type not select </div>
            </div>
            <div>
                <div>
                    <font size="3">Card Expiry Month:</font>
                </div>
                <input class="inputs" type="text" placeholder="MM" formControlName="expiryMonth">
                <div class="error" *ngIf="required( 'expiryMonth')">Card Expiry Month is required</div>
            </div>
            <div>
                <div>
                    <font size="3">Card Expiry Year:</font>
                </div>
                <input class="inputs" type="text" placeholder="YYYY" formControlName="expiryYear">
                <div class="error" *ngIf="required( 'expiryYear')">Card Expiry Year is required</div>
            </div>
            <div>
                <div>
                    <font size="3">Card Verification Number:</font>
                </div>
                <input class="inputs" type="text" placeholder="Card Verification Number" formControlName="cvn">
                <div class="error" *ngIf="required( 'cvn')">Card Verification Number is required</div>
            </div>

            <input type="checkbox" class="savePaymentMethodAsDefault" (change)="toggleDefaultPaymentMethod()">Save As Default
            <br>
        </div>

        <div class="buttons">
            <button *ngIf="newPayment" mat-raised-button color="primary" (click)="back()">Change Payment</button>
            <button *ngIf="!newPayment" mat-raised-button color="primary" (click)="back()">Go Back</button>
            <button [disabled]="payment.invalid || notSelected( 'cardType.code')" (click)="next()">Next
            </button>
        </div>
    </div>
</ng-template>