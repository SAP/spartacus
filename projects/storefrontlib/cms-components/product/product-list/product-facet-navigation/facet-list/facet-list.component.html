<div
  class="inner"
  *ngIf="(facetList$ | async)?.facets as facets"
  [cxFocus]="isDialog ? dialogFocusConfig : {}"
  (esc)="close($event)"
  (click)="block($event)"
>
  <h4>
    {{ 'productList.filterBy.label' | cxTranslate }}
    <button
      type="button"
      class="close"
      [attr.aria-label]="'common.close' | cxTranslate"
      (click)="close()"
    >
      <cx-icon aria-hidden="true" [type]="iconTypes.CLOSE"></cx-icon>
    </button>
  </h4>

  <!-- 
      Here we'd like to introduce configurable facet components, 
      either by using specific configuration or generic sproutlets 
  -->
  <ng-container *cxFeatureLevel="'!4.1'">
    <cx-facet
      *ngFor="let facet of facets"
      #facetRef
      [facet]="facet"
      [cxFocus]="{ lock: true, trap: true, autofocus: 'a' }"
      (unlock)="expandFacetGroup(facet, facetRef)"
      [class.expanded]="isExpanded(facet) | async"
      [class.collapsed]="isCollapsed(facet) | async"
    ></cx-facet>
  </ng-container>

  <ng-container *cxFeatureLevel="'4.2'">
    <cx-tab [tabs$]="tabs$" [config]="tabConfig"></cx-tab>

    <ng-template #facetsRef *ngFor="let facet of facets">
      <cx-facet [facet]="facet"></cx-facet>
    </ng-template>
  </ng-container>
</div>
