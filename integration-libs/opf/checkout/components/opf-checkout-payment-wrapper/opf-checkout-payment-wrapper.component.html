<div
  class="cx-payment-option-container"
  *ngIf="renderPaymentMethodEvent$ | async as paymentLink"
>
  <ng-container
    *ngTemplateOutlet="
      !paymentLink?.isLoading ? paymentData : noPaymentData;
      context: { paymentLink: paymentLink }
    "
  >
  </ng-container>
</div>

<ng-template #paymentData let-paymentLink="paymentLink">
  <div>
    <div
      *ngIf="paymentLink.renderType === RENDER_TYPES.DESTINATION"
      class="cx-payment-link"
    >
      <a
        *ngIf="!paymentLink.destination?.form?.length"
        class="btn btn-primary"
        [href]="paymentLink.data"
        >{{ 'opf.checkout.proceedPayment' | cxTranslate }}</a
      >

      <form
        *ngIf="paymentLink.destination?.form?.length"
        [action]="paymentLink.destination?.url"
        [method]="paymentLink.destination?.method"
        [enctype]="paymentLink.destination?.contentType"
      >
        <fieldset>
          <input
            *ngFor="let field of paymentLink.destination?.form"
            type="hidden"
            [name]="field?.name"
            [value]="field?.value"
          />
        </fieldset>
        <input
          class="btn btn-primary"
          type="submit"
          [value]="'opf.checkout.proceedPayment' | cxTranslate"
        />
      </form>
    </div>
    <ng-container
      *ngIf="
        paymentLink.data &&
        paymentLink.renderType === RENDER_TYPES.DYNAMIC_SCRIPT
      "
    >
      <div [innerHTML]="renderHtml(paymentLink.data)"></div>
    </ng-container>
  </div>
</ng-template>

<ng-template #noPaymentData let-paymentLink="paymentLink">
  <ng-container *ngIf="paymentLink?.isError; else loading">
    <div class="cx-payment-option-container">
      <div class="cx-payment-link">
        <button [ngClass]="'btn btn-primary'" (click)="retryInitiatePayment()">
          {{ 'opf.checkout.retryPayment' | cxTranslate }}
        </button>
      </div>
    </div>
  </ng-container>

  <ng-template #loading>
    <cx-spinner></cx-spinner>
  </ng-template>
</ng-template>
