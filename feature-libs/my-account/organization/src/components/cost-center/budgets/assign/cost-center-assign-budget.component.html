<cx-view #view *ngIf="code$ | async as costCenterCode">
  <h3>
    <a
      class="link"
      [routerLink]="
        { cxRoute: 'costCenterBudgets', params: { code: costCenterCode } }
          | cxUrl
      "
      (click)="view.toggle()"
    >
      <cx-icon type="CARET_LEFT"></cx-icon>
      {{ 'organization.back' | cxTranslate }}
    </a>
    {{ 'costCenter.budget.assign' | cxTranslate }}
    <span></span>
  </h3>

  <section>
    <cx-table
      *ngIf="dataTable$ | async as budgets; else emptyList"
      [dataset]="budgets"
    >
    </cx-table>
  </section>

  <ng-template #emptyList>
    <p class="instruction is-empty">
      {{ 'organization.messages.emptyList' | cxTranslate }}
    </p>
  </ng-template>

  <ng-template
    cxOutletRef="table.costCenterAssignBudget.data.summary"
    let-model
  >
    <div>
      <div>
        <label>
          <input
            type="checkbox"
            [checked]="model.selected"
            (change)="
              toggleAssign(costCenterCode, model.code, $event.target.checked)
            "
          />
        </label>
        <h3>{{ model.name }}</h3>
        <small
          >{{ model.code }} • {{ model.budget }} {{ model.currency?.symbol }} •
          {{ model.startDate | cxDate }} - {{ model.endDate | cxDate }}
        </small>
      </div>
      <div>
        <a
          class="link"
          [routerLink]="
            {
              cxRoute: 'budgetDetails',
              params: { code: model.code }
            } | cxUrl
          "
        >
          <cx-icon class="open-out" type="LINK_OUT"></cx-icon>
        </a>
      </div>
    </div>
  </ng-template>

  <ng-template cxOutletRef="table.costCenterAssignBudget.data.name" let-model>
    <label>
      <input
        type="checkbox"
        [checked]="model.selected"
        (change)="
          toggleAssign(costCenterCode, model.code, $event.target.checked)
        "
      />
      <span class="text">{{ model.name }}</span>
    </label>
  </ng-template>

  <ng-template cxOutletRef="table.costCenterAssignBudget.data.code" let-model>
    <span class="text">{{ model.code }}</span>
    <a
      class="link"
      [routerLink]="
        {
          cxRoute: 'budgetDetails',
          params: { code: model.code }
        } | cxUrl
      "
    >
      <cx-icon class="open-out" type="LINK_OUT"></cx-icon>
    </a>
  </ng-template>

  <ng-template cxOutletRef="table.costCenterAssignBudget.data.amount" let-model>
    <span class="text">{{ model.budget }} {{ model.currency?.isocode }}</span>
  </ng-template>

  <ng-template
    cxOutletRef="table.costCenterAssignBudget.data.dateRange"
    let-model
  >
    <span class="text"
      >{{ model.startDate | cxDate }} - {{ model.endDate | cxDate }}</span
    >
  </ng-template>
</cx-view>
