<ng-container *ngIf="cart$ | async as cart">
  <div class="cart-details-wrapper">
    <cx-cart-validation-warnings></cx-cart-validation-warnings>

    <h2 class="cx-total">
      {{ 'cartDetails.cartName' | cxTranslate: { code: cart.code } }}
    </h2>

    <cx-promotions
      [promotions]="
        (cart.appliedOrderPromotions || []).concat(
          cart.potentialOrderPromotions || []
        )
      "
    ></cx-promotions>

    <ng-container *ngIf="entries$ | async as entries">
      <cx-cart-item-list
        [items]="entries"
        [cartIsLoading]="!(cartLoaded$ | async)"
        [promotionLocation]="promotionLocation"
        [options]="{
          isSaveForLater: false,
          optionalBtn: saveForLaterBtn,
        }"
        [ngClass]="entries.length === 0 ? 'emptyList' : 'noneEmptyList'"
      ></cx-cart-item-list>
    </ng-container>
    <ng-container *cxFeature="'enableBundles'">
      <ng-container *ngFor="let bundle of bundles$ | async">
        <cx-hierarchy
          [tree]="bundle"
          [template]="bundlesTemplate"
          [activeCartService]="activeCartService"
        >
        </cx-hierarchy>
      </ng-container>
    </ng-container>
  </div>
</ng-container>

<ng-template let-ctx #saveForLaterBtn>
  <button
    *ngIf="selectiveCartEnabled"
    class="btn btn-tertiary cx-sfl-btn"
    [disabled]="ctx.loading"
    (click)="saveForLater(ctx.item)"
    type="button"
  >
    {{ 'saveForLaterItems.saveForLater' | cxTranslate }}
  </button>
</ng-template>

<ng-template #bundlesTemplate let-items>
  <ng-template
    [cxOutlet]="cartOutlets.CART_ITEM_LIST"
    [cxOutletContext]="{
      items: items,
      hasHeader: false,
    }"
  >
  </ng-template>
</ng-template>
