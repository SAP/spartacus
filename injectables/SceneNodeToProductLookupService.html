<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>storefrontapp documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">storefrontapp documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li >SceneNodeToProductLookupService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#nodeIdsByProductCodeMap$" >nodeIdsByProductCodeMap$</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#productCodesByNodeIdMap$" >productCodesByNodeIdMap$</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#usageId" >usageId</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_lookupNodeIds" >_lookupNodeIds</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_lookupProductCodes" >_lookupProductCodes</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#distinct" >distinct</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getNodeIdProductCodesForScene" >getNodeIdProductCodesForScene</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getNodeIdsByProductCodeMap" >getNodeIdsByProductCodeMap</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getProductCodesByNodeIdMap" >getProductCodesByNodeIdMap</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#lookupNodeIds" >lookupNodeIds</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#lookupProductCodes" >lookupProductCodes</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#populateMapsForScene" >populateMapsForScene</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#syncLookupNodeIds" >syncLookupNodeIds</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#syncLookupProductCodes" >syncLookupProductCodes</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(epdVisualizationConfig: <a href="../injectables/EpdVisualizationConfig.html" target="_self">EpdVisualizationConfig</a>, sceneConnector: <a href="../injectables/SceneConnector.html" target="_self">SceneConnector</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:24</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>epdVisualizationConfig</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/EpdVisualizationConfig.html" target="_self" >EpdVisualizationConfig</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>sceneConnector</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/SceneConnector.html" target="_self" >SceneConnector</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_lookupNodeIds"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>_lookupNodeIds</b></span>
                        <a href="#_lookupNodeIds"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>_lookupNodeIds(nodeIdsByProductCodeMap: Map<string | string[]>, productCodes: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="183"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:183</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodeIdsByProductCodeMap</td>
                                    <td>
                                            <code>Map&lt;string | string[]&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>productCodes</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>string[]</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_lookupProductCodes"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>_lookupProductCodes</b></span>
                        <a href="#_lookupProductCodes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>_lookupProductCodes(productCodesByNodeIdMap: Map<string | string[]>, nodeIds: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="146"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:146</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>productCodesByNodeIdMap</td>
                                    <td>
                                            <code>Map&lt;string | string[]&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>nodeIds</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>string[]</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="distinct"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>distinct</b></span>
                        <a href="#distinct"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>distinct(values: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="134"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:134</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Get distinct values while retaining ordering.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>values</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getNodeIdProductCodesForScene"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>getNodeIdProductCodesForScene</b></span>
                        <a href="#getNodeIdProductCodesForScene"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getNodeIdProductCodesForScene(sceneId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="62"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:62</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>sceneId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;NodeIdProductCodes[]&gt;</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getNodeIdsByProductCodeMap"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>getNodeIdsByProductCodeMap</b></span>
                        <a href="#getNodeIdsByProductCodeMap"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getNodeIdsByProductCodeMap(nodeIdProductCodes: NodeIdProductCodes[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="107"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:107</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodeIdProductCodes</td>
                                    <td>
                                            <code>NodeIdProductCodes[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Map&lt;string, string[]&gt;</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getProductCodesByNodeIdMap"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>getProductCodesByNodeIdMap</b></span>
                        <a href="#getProductCodesByNodeIdMap"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getProductCodesByNodeIdMap(nodeIdProductCodes: NodeIdProductCodes[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="89"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:89</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodeIdProductCodes</td>
                                    <td>
                                            <code>NodeIdProductCodes[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Map&lt;string, string[]&gt;</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="lookupNodeIds"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>lookupNodeIds</b></span>
                        <a href="#lookupNodeIds"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>lookupNodeIds(productCodes: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="199"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:199</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Returns an Observable producing an array of scene node ids corresponding to the specified product codes in the currently loaded scene.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>productCodes</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The product codes.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;string[]&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>An Observable producing an array of scene node ids corresponding to the specified product codes in the currently loaded scene.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="lookupProductCodes"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>lookupProductCodes</b></span>
                        <a href="#lookupProductCodes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>lookupProductCodes(nodeIds: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="160"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:160</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Returns an Observable producing an array of product codes corresponding to the specified scene node ids in the currently loaded scene.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodeIds</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The scene node ids.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;string[]&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>An Observable producing an array of product codes corresponding to the specified scene node ids in the currently loaded scene.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="populateMapsForScene"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>populateMapsForScene</b></span>
                        <a href="#populateMapsForScene"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>populateMapsForScene(sceneId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="42"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:42</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Called to populate the maps with the data for the given scene.
This can be done before the scene has been loaded since this just involves a storage service API call</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>sceneId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The scene id of the loaded scene.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="syncLookupNodeIds"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>syncLookupNodeIds</b></span>
                        <a href="#syncLookupNodeIds"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>syncLookupNodeIds(productCodes: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="214"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:214</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Returns an array of scene node ids corresponding to the specified product codes in the currently loaded scene.
Returns an empty array if the map of node ids by product code has not yet been populated.
For cases where the code must execute synchronously.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>productCodes</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The product codes.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>string[]</code>

                    </div>
                    <div class="io-description">
                        <p>An array of scene node ids corresponding to the specified product codes in the currently loaded scene.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="syncLookupProductCodes"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>syncLookupProductCodes</b></span>
                        <a href="#syncLookupProductCodes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>syncLookupProductCodes(nodeIds: string[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="176"
                            class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:176</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Returns an array of product codes corresponding to the specified scene node ids in the currently loaded scene.
Returns an empty array if the map of product codes by node id has not yet been populated.
For cases where the code must execute synchronously.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodeIds</td>
                                    <td>
                                            <code>string[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The scene node ids.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>string[]</code>

                    </div>
                    <div class="io-description">
                        <p>An array of product codes corresponding to the specified scene node ids in the currently loaded scene.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="nodeIdsByProductCodeMap$"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>nodeIdsByProductCodeMap$</b></span>
                        <a href="#nodeIdsByProductCodeMap$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject&lt;Map&lt;string, string[]&gt;&gt;(
    new Map()
  )</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="58" class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:58</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="productCodesByNodeIdMap$"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>productCodesByNodeIdMap$</b></span>
                        <a href="#productCodesByNodeIdMap$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject&lt;Map&lt;string, string[]&gt;&gt;(
    new Map()
  )</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="55" class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:55</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="usageId"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>usageId</b></span>
                        <a href="#usageId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">integration-libs/epd-visualization/core/services/scene-node-to-product-lookup/scene-node-to-product-lookup.service.ts:35</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@angular/core&#x27;;
import {
  EpdVisualizationConfig,
  EpdVisualizationInnerConfig,
  UsageIdConfig,
} from &#x27;@spartacus/epd-visualization/root&#x27;;
import { BehaviorSubject, Observable } from &#x27;rxjs&#x27;;
import { first, map } from &#x27;rxjs/operators&#x27;;
import {
  Metadatum,
  NodesResponse,
  TreeNode,
} from &#x27;../../connectors/scene/nodes-response&#x27;;
import { SceneConnector } from &#x27;../../connectors/scene/scene.connector&#x27;;

export interface NodeIdProductCodes {
  nodeId: string;
  productCodes: string[];
}

@Injectable({
  providedIn: &#x27;root&#x27;,
})
export class SceneNodeToProductLookupService {
  constructor(
    protected epdVisualizationConfig: EpdVisualizationConfig,
    protected sceneConnector: SceneConnector
  ) {
    const epdVisualization &#x3D; this.epdVisualizationConfig
      .epdVisualization as EpdVisualizationInnerConfig;
    const usageIdConfig &#x3D; epdVisualization.usageIds as UsageIdConfig;
    this.usageId &#x3D; usageIdConfig.productUsageId;
  }

  private usageId;

  /**
   * Called to populate the maps with the data for the given scene.
   * This can be done before the scene has been loaded since this just involves a storage service API call
   * @param sceneId The scene id of the loaded scene.
   */
  public populateMapsForScene(sceneId: string): void {
    this.getNodeIdProductCodesForScene(sceneId)
      .pipe(first())
      .subscribe((nodeIdProductCodes: NodeIdProductCodes[]) &#x3D;&gt; {
        this.productCodesByNodeIdMap$.next(
          this.getProductCodesByNodeIdMap(nodeIdProductCodes)
        );
        this.nodeIdsByProductCodeMap$.next(
          this.getNodeIdsByProductCodeMap(nodeIdProductCodes)
        );
      });
  }

  private productCodesByNodeIdMap$ &#x3D; new BehaviorSubject&lt;Map&lt;string, string[]&gt;&gt;(
    new Map()
  );
  private nodeIdsByProductCodeMap$ &#x3D; new BehaviorSubject&lt;Map&lt;string, string[]&gt;&gt;(
    new Map()
  );

  private getNodeIdProductCodesForScene(
    sceneId: string
  ): Observable&lt;NodeIdProductCodes[]&gt; {
    return this.sceneConnector
      .getNodes(
        sceneId,
        undefined,
        [&#x27;hotspot&#x27;, &#x60;meta.${this.usageId.category}.${this.usageId.keyName}&#x60;],
        [&#x60;metadata.${this.usageId.category}.${this.usageId.keyName}&#x60;],
        &#x27;*&#x27;
      )
      .pipe(
        map((data: NodesResponse) &#x3D;&gt; {
          return (data.nodes as TreeNode[])
            .filter((node: TreeNode) &#x3D;&gt; node.metadata &amp;&amp; node.metadata.length)
            .map((node: TreeNode) &#x3D;&gt; {
              return &lt;NodeIdProductCodes&gt;{
                nodeId: node.sid,
                productCodes: (node.metadata as Metadatum[]).map(
                  (metadata: any) &#x3D;&gt; metadata.value
                ),
              };
            });
        })
      );
  }

  private getProductCodesByNodeIdMap(
    nodeIdProductCodes: NodeIdProductCodes[]
  ): Map&lt;string, string[]&gt; {
    return nodeIdProductCodes.reduce(
      (
        productCodeByNodeIdMap: Map&lt;string, string[]&gt;,
        nodeIdProductCodeTuple: NodeIdProductCodes
      ) &#x3D;&gt; {
        productCodeByNodeIdMap.set(
          nodeIdProductCodeTuple.nodeId,
          nodeIdProductCodeTuple.productCodes
        );
        return productCodeByNodeIdMap;
      },
      new Map&lt;string, string[]&gt;()
    );
  }

  private getNodeIdsByProductCodeMap(
    nodeIdProductCodes: NodeIdProductCodes[]
  ): Map&lt;string, string[]&gt; {
    return nodeIdProductCodes.reduce(
      (
        nodeIdByProductCodeMap: Map&lt;string, string[]&gt;,
        nodeIdProductCodeTuple: NodeIdProductCodes
      ) &#x3D;&gt; {
        nodeIdProductCodeTuple.productCodes.forEach((productCode) &#x3D;&gt; {
          const nodeIds &#x3D; nodeIdByProductCodeMap.get(productCode);
          if (nodeIds !&#x3D;&#x3D; undefined) {
            nodeIds.push(nodeIdProductCodeTuple.nodeId);
          } else {
            nodeIdByProductCodeMap.set(productCode, [
              nodeIdProductCodeTuple.nodeId,
            ]);
          }
        });
        return nodeIdByProductCodeMap;
      },
      new Map&lt;string, string[]&gt;()
    );
  }

  /**
   * Get distinct values while retaining ordering.
   */
  private distinct(values: string[]) {
    const uniqueArray: string[] &#x3D; [];
    const valueSet &#x3D; new Set();
    values.forEach((value) &#x3D;&gt; {
      if (!valueSet.has(value)) {
        valueSet.add(value);
        uniqueArray.push(value);
      }
    });
    return uniqueArray;
  }

  private _lookupProductCodes(
    productCodesByNodeIdMap: Map&lt;string, string[]&gt;,
    nodeIds: string[]
  ): string[] {
    return this.distinct(
      nodeIds.flatMap((nodeId) &#x3D;&gt; productCodesByNodeIdMap.get(nodeId) || [])
    );
  }

  /**
   * Returns an Observable producing an array of product codes corresponding to the specified scene node ids in the currently loaded scene.
   * @param nodeIds The scene node ids.
   * @returns An Observable producing an array of product codes corresponding to the specified scene node ids in the currently loaded scene.
   */
  public lookupProductCodes(nodeIds: string[]): Observable&lt;string[]&gt; {
    return this.productCodesByNodeIdMap$.pipe(
      first(),
      map((productCodesByNodeIdMap) &#x3D;&gt;
        this._lookupProductCodes(productCodesByNodeIdMap, nodeIds)
      )
    );
  }

  /**
   * Returns an array of product codes corresponding to the specified scene node ids in the currently loaded scene.
   * Returns an empty array if the map of product codes by node id has not yet been populated.
   * For cases where the code must execute synchronously.
   * @param nodeIds The scene node ids.
   * @returns An array of product codes corresponding to the specified scene node ids in the currently loaded scene.
   */
  public syncLookupProductCodes(nodeIds: string[]): string[] {
    return this._lookupProductCodes(
      this.productCodesByNodeIdMap$.getValue(),
      nodeIds
    );
  }

  private _lookupNodeIds(
    nodeIdsByProductCodeMap: Map&lt;string, string[]&gt;,
    productCodes: string[]
  ): string[] {
    return this.distinct(
      productCodes.flatMap(
        (productCode) &#x3D;&gt; nodeIdsByProductCodeMap.get(productCode) || []
      )
    );
  }

  /**
   * Returns an Observable producing an array of scene node ids corresponding to the specified product codes in the currently loaded scene.
   * @param productCodes The product codes.
   * @returns An Observable producing an array of scene node ids corresponding to the specified product codes in the currently loaded scene.
   */
  public lookupNodeIds(productCodes: string[]): Observable&lt;string[]&gt; {
    return this.nodeIdsByProductCodeMap$.pipe(
      map((nodeIdsByProductCodeMap) &#x3D;&gt;
        this._lookupNodeIds(nodeIdsByProductCodeMap, productCodes)
      )
    );
  }

  /**
   * Returns an array of scene node ids corresponding to the specified product codes in the currently loaded scene.
   * Returns an empty array if the map of node ids by product code has not yet been populated.
   * For cases where the code must execute synchronously.
   * @param productCodes The product codes.
   * @returns An array of scene node ids corresponding to the specified product codes in the currently loaded scene.
   */
  public syncLookupNodeIds(productCodes: string[]): string[] {
    return this._lookupNodeIds(
      this.nodeIdsByProductCodeMap$.getValue(),
      productCodes
    );
  }
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'SceneNodeToProductLookupService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
